2025-12-03 15:04:53.489146: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-12-03 15:05:19.206096: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
TensorFlow version: 2.20.0
GPU Available: []
==================================================
DenseNet-121 Emotion Recognition Model Training
==================================================

[INFO] Preparing data generators...
[INFO] Resolved dataset root: C:\Users\avi\OneDrive - Sri Lanka Institute of Information Technology\Desktop\Personalized-Autism-Therapy-Support-System\ml_service\dataset\Autism emotion recogition dataset\Autism emotion recogition dataset\train
Found 960 images belonging to 6 classes.
Found 239 images belonging to 6 classes.
Class indices: {'Natural': 0, 'anger': 1, 'fear': 2, 'joy': 3, 'sadness': 4, 'surprise': 5}
Number of training samples: 960
Number of validation samples: 239

[INFO] Creating DenseNet-121 model...
2025-12-03 15:05:34.786706: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: SSE3 SSE4.1 SSE4.2 AVX AVX2 AVX_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.

[INFO] Model Summary:
Model: "functional"
+--------------------------------------------------------------------------+
| Layer (type)                    | Output Shape           |       Param # |
|---------------------------------+------------------------+---------------|
| input_layer_1 (InputLayer)      | (None, 224, 224, 3)    |             0 |
|---------------------------------+------------------------+---------------|
| true_divide (TrueDivide)        | (None, 224, 224, 3)    |             0 |
|---------------------------------+------------------------+---------------|
| add (Add)                       | (None, 224, 224, 3)    |             0 |
|---------------------------------+------------------------+---------------|
| true_divide_1 (TrueDivide)      | (None, 224, 224, 3)    |             0 |
|---------------------------------+------------------------+---------------|
| densenet121 (Functional)        | (None, 7, 7, 1024)     |     7,037,504 |
|---------------------------------+------------------------+---------------|
| global_average_pooling2d        | (None, 1024)           |             0 |
| (GlobalAveragePooling2D)        |                        |               |
|---------------------------------+------------------------+---------------|
| dropout (Dropout)               | (None, 1024)           |             0 |
|---------------------------------+------------------------+---------------|
| dense (Dense)                   | (None, 512)            |       524,800 |
|---------------------------------+------------------------+---------------|
| batch_normalization             | (None, 512)            |         2,048 |
| (BatchNormalization)            |                        |               |
|---------------------------------+------------------------+---------------|
| dropout_1 (Dropout)             | (None, 512)            |             0 |
|---------------------------------+------------------------+---------------|
| dense_1 (Dense)                 | (None, 256)            |       131,328 |
|---------------------------------+------------------------+---------------|
| batch_normalization_1           | (None, 256)            |         1,024 |
| (BatchNormalization)            |                        |               |
|---------------------------------+------------------------+---------------|
| dropout_2 (Dropout)             | (None, 256)            |             0 |
|---------------------------------+------------------------+---------------|
| dense_2 (Dense)                 | (None, 6)              |         1,542 |
+--------------------------------------------------------------------------+
 Total params: 7,698,246 (29.37 MB)
 Trainable params: 659,206 (2.51 MB)
 Non-trainable params: 7,039,040 (26.85 MB)

[INFO] Starting training (Phase 1: Frozen base model)...
   Epochs: 50
   Batch size: 32
   Learning rate: 0.001
Epoch 1/50

[1m 1/30[0m [37m====================[0m [1m1:21:02[0m 168s/step - accuracy: 0.1562 - loss: 3.1509 - top_k_categorical_accuracy: 0.8125
[1m 2/30[0m [32m=[0m[37m===================[0m [1m1:45[0m 4s/step - accuracy: 0.1406 - loss: 3.1111 - top_k_categorical_accuracy: 0.8047     
[1m 3/30[0m [32m==[0m[37m==================[0m [1m1:54[0m 4s/step - accuracy: 0.1458 - loss: 3.0571 - top_k_categorical_accuracy: 0.8073
[1m 4/30[0m [32m==[0m[37m==================[0m [1m1:53[0m 4s/step - accuracy: 0.1426 - loss: 3.0161 - top_k_categorical_accuracy: 0.8066
[1m 5/30[0m [32m===[0m[37m=================[0m [1m1:44[0m 4s/step - accuracy: 0.1403 - loss: 3.0017 - top_k_categorical_accuracy: 0.8041
[1m 6/30[0m [32m====[0m[37m================[0m [1m1:40[0m 4s/step - accuracy: 0.1430 - loss: 2.9790 - top_k_categorical_accuracy: 0.8046
[1m 7/30[0m [32m====[0m[37m================[0m [1m1:35[0m 4s/step - accuracy: 0.1461 - loss: 2.9537 - top_k_categorical_accuracy: 0.8064
[1m 8/30[0m [32m=====[0m[37m===============[0m [1m1:30[0m 4s/step - accuracy: 0.1494 - loss: 2.9315 - top_k_categorical_accuracy: 0.8076
[1m 9/30[0m [32m======[0m[37m==============[0m [1m1:25[0m 4s/step - accuracy: 0.1501 - loss: 2.9174 - top_k_categorical_accuracy: 0.8085
[1m10/30[0m [32m======[0m[37m==============[0m [1m1:19[0m 4s/step - accuracy: 0.1501 - loss: 2.9090 - top_k_categorical_accuracy: 0.8086
[1m11/30[0m [32m=======[0m[37m=============[0m [1m1:12[0m 4s/step - accuracy: 0.1491 - loss: 2.9023 - top_k_categorical_accuracy: 0.8090
[1m12/30[0m [32m========[0m[37m============[0m [1m1:08[0m 4s/step - accuracy: 0.1484 - loss: 2.8953 - top_k_categorical_accuracy: 0.8095
[1m13/30[0m [32m========[0m[37m============[0m [1m1:05[0m 4s/step - accuracy: 0.1477 - loss: 2.8896 - top_k_categorical_accuracy: 0.8103
[1m14/30[0m [32m=========[0m[37m===========[0m [1m1:03[0m 4s/step - accuracy: 0.1472 - loss: 2.8843 - top_k_categorical_accuracy: 0.8108
[1m15/30[0m [32m==========[0m[37m==========[0m [1m1:01[0m 4s/step - accuracy: 0.1468 - loss: 2.8810 - top_k_categorical_accuracy: 0.8110
[1m16/30[0m [32m==========[0m[37m==========[0m [1m58s[0m 4s/step - accuracy: 0.1463 - loss: 2.8780 - top_k_categorical_accuracy: 0.8112 
[1m17/30[0m [32m===========[0m[37m=========[0m [1m55s[0m 4s/step - accuracy: 0.1462 - loss: 2.8739 - top_k_categorical_accuracy: 0.8118
[1m18/30[0m [32m============[0m[37m========[0m [1m52s[0m 4s/step - accuracy: 0.1459 - loss: 2.8696 - top_k_categorical_accuracy: 0.8126
[1m19/30[0m [32m============[0m[37m========[0m [1m49s[0m 4s/step - accuracy: 0.1459 - loss: 2.8657 - top_k_categorical_accuracy: 0.8131
[1m20/30[0m [32m=============[0m[37m=======[0m [1m45s[0m 5s/step - accuracy: 0.1458 - loss: 2.8615 - top_k_categorical_accuracy: 0.8137
[1m21/30[0m [32m==============[0m[37m======[0m [1m41s[0m 5s/step - accuracy: 0.1460 - loss: 2.8568 - top_k_categorical_accuracy: 0.8144
[1m22/30[0m [32m==============[0m[37m======[0m [1m37s[0m 5s/step - accuracy: 0.1464 - loss: 2.8520 - top_k_categorical_accuracy: 0.8151
[1m23/30[0m [32m===============[0m[37m=====[0m [1m32s[0m 5s/step - accuracy: 0.1471 - loss: 2.8464 - top_k_categorical_accuracy: 0.8160
[1m24/30[0m [32m================[0m[37m====[0m [1m27s[0m 5s/step - accuracy: 0.1478 - loss: 2.8406 - top_k_categorical_accuracy: 0.8169
[1m25/30[0m [32m================[0m[37m====[0m [1m22s[0m 5s/step - accuracy: 0.1486 - loss: 2.8348 - top_k_categorical_accuracy: 0.8175
[1m26/30[0m [32m=================[0m[37m===[0m [1m18s[0m 5s/step - accuracy: 0.1494 - loss: 2.8290 - top_k_categorical_accuracy: 0.8183
[1m27/30[0m [32m==================[0m[37m==[0m [1m14s[0m 5s/step - accuracy: 0.1502 - loss: 2.8231 - top_k_categorical_accuracy: 0.8189
[1m28/30[0m [32m==================[0m[37m==[0m [1m9s[0m 5s/step - accuracy: 0.1509 - loss: 2.8174 - top_k_categorical_accuracy: 0.8195 
[1m29/30[0m [32m===================[0m[37m=[0m [1m4s[0m 5s/step - accuracy: 0.1517 - loss: 2.8117 - top_k_categorical_accuracy: 0.8202
[1m30/30[0m [32m====================[0m[37m[0m [1m0s[0m 5s/step - accuracy: 0.1523 - loss: 2.8062 - top_k_categorical_accuracy: 0.8208
Epoch 1: val_accuracy improved from None to 0.17992, saving model to models/densenet121_emotion_model.h5
WARNING:absl:You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 

[1m30/30[0m [32m====================[0m[37m[0m [1m416s[0m 9s/step - accuracy: 0.1708 - loss: 2.6489 - top_k_categorical_accuracy: 0.8385 - val_accuracy: 0.1799 - val_loss: 1.8538 - val_top_k_categorical_accuracy: 0.8326 - learning_rate: 0.0010
Epoch 2/50

[1m 1/30[0m [37m====================[0m [1m5:25[0m 11s/step - accuracy: 0.2188 - loss: 2.1497 - top_k_categorical_accuracy: 0.8438
[1m 2/30[0m [32m=[0m[37m===================[0m [1m1:57[0m 4s/step - accuracy: 0.2188 - loss: 2.2375 - top_k_categorical_accuracy: 0.8359 
[1m 3/30[0m [32m==[0m[37m==================[0m [1m2:06[0m 5s/step - accuracy: 0.2118 - loss: 2.2936 - top_k_categorical_accuracy: 0.8316
[1m 4/30[0m [32m==[0m[37m==================[0m [1m2:11[0m 5s/step - accuracy: 0.2057 - loss: 2.3403 - top_k_categorical_accuracy: 0.8346
[1m 5/30[0m [32m===[0m[37m=================[0m [1m2:10[0m 5s/step - accuracy: 0.1983 - loss: 2.3787 - top_k_categorical_accuracy: 0.8327
[1m 6/30[0m [32m====[0m[37m================[0m [1m2:08[0m 5s/step - accuracy: 0.1939 - loss: 2.4000 - top_k_categorical_accuracy: 0.8319
[1m 7/30[0m [32m====[0m[37m================[0m [1m2:04[0m 5s/step - accuracy: 0.1917 - loss: 2.4163 - top_k_categorical_accuracy: 0.8317
[1m 8/30[0m [32m=====[0m[37m===============[0m [1m2:00[0m 5s/step - accuracy: 0.1902 - loss: 2.4264 - top_k_categorical_accuracy: 0.8318
[1m 9/30[0m [32m======[0m[37m==============[0m [1m1:55[0m 6s/step - accuracy: 0.1892 - loss: 2.4343 - top_k_categorical_accuracy: 0.8315
[1m10/30[0m [32m======[0m[37m==============[0m [1m1:52[0m 6s/step - accuracy: 0.1893 - loss: 2.4371 - top_k_categorical_accuracy: 0.8321
[1m11/30[0m [32m=======[0m[37m=============[0m [1m1:48[0m 6s/step - accuracy: 0.1897 - loss: 2.4381 - top_k_categorical_accuracy: 0.8327
[1m12/30[0m [32m========[0m[37m============[0m [1m1:43[0m 6s/step - accuracy: 0.1916 - loss: 2.4368 - top_k_categorical_accuracy: 0.8327
[1m13/30[0m [32m========[0m[37m============[0m [1m1:37[0m 6s/step - accuracy: 0.1932 - loss: 2.4358 - top_k_categorical_accuracy: 0.8328
[1m14/30[0m [32m=========[0m[37m===========[0m [1m1:32[0m 6s/step - accuracy: 0.1948 - loss: 2.4331 - top_k_categorical_accuracy: 0.8330
[1m15/30[0m [32m==========[0m[37m==========[0m [1m1:27[0m 6s/step - accuracy: 0.1962 - loss: 2.4311 - top_k_categorical_accuracy: 0.8326
[1m16/30[0m [32m==========[0m[37m==========[0m [1m1:19[0m 6s/step - accuracy: 0.1970 - loss: 2.4288 - top_k_categorical_accuracy: 0.8324
[1m17/30[0m [32m===========[0m[37m=========[0m [1m1:14[0m 6s/step - accuracy: 0.1975 - loss: 2.4284 - top_k_categorical_accuracy: 0.8318
[1m18/30[0m [32m============[0m[37m========[0m [1m1:09[0m 6s/step - accuracy: 0.1981 - loss: 2.4282 - top_k_categorical_accuracy: 0.8310
[1m19/30[0m [32m============[0m[37m========[0m [1m1:03[0m 6s/step - accuracy: 0.1990 - loss: 2.4272 - top_k_categorical_accuracy: 0.8305
[1m20/30[0m [32m=============[0m[37m=======[0m [1m58s[0m 6s/step - accuracy: 0.1997 - loss: 2.4266 - top_k_categorical_accuracy: 0.8299 
[1m21/30[0m [32m==============[0m[37m======[0m [1m52s[0m 6s/step - accuracy: 0.2002 - loss: 2.4259 - top_k_categorical_accuracy: 0.8293
[1m22/30[0m [32m==============[0m[37m======[0m [1m46s[0m 6s/step - accuracy: 0.2006 - loss: 2.4252 - top_k_categorical_accuracy: 0.8290
[1m23/30[0m [32m===============[0m[37m=====[0m [1m41s[0m 6s/step - accuracy: 0.2009 - loss: 2.4245 - top_k_categorical_accuracy: 0.8284
[1m24/30[0m [32m================[0m[37m====[0m [1m35s[0m 6s/step - accuracy: 0.2012 - loss: 2.4243 - top_k_categorical_accuracy: 0.8281
[1m25/30[0m [32m================[0m[37m====[0m [1m29s[0m 6s/step - accuracy: 0.2013 - loss: 2.4243 - top_k_categorical_accuracy: 0.8278
[1m26/30[0m [32m=================[0m[37m===[0m [1m23s[0m 6s/step - accuracy: 0.2013 - loss: 2.4243 - top_k_categorical_accuracy: 0.8277
[1m27/30[0m [32m==================[0m[37m==[0m [1m17s[0m 6s/step - accuracy: 0.2011 - loss: 2.4241 - top_k_categorical_accuracy: 0.8275
[1m28/30[0m [32m==================[0m[37m==[0m [1m11s[0m 6s/step - accuracy: 0.2009 - loss: 2.4240 - top_k_categorical_accuracy: 0.8275
[1m29/30[0m [32m===================[0m[37m=[0m [1m5s[0m 6s/step - accuracy: 0.2006 - loss: 2.4237 - top_k_categorical_accuracy: 0.8274 
[1m30/30[0m [32m====================[0m[37m[0m [1m0s[0m 6s/step - accuracy: 0.2004 - loss: 2.4232 - top_k_categorical_accuracy: 0.82752025-12-03 15:15:58.861054: W tensorflow/core/kernels/data/prefetch_autotuner.cc:55] Prefetch autotuner tried to allocate 19268352 bytes after encountering the first element of size 19268352 bytes.This already causes the autotune ram budget to be exceeded. To stay within the ram budget, either increase the ram budget or reduce element size

Epoch 2: val_accuracy improved from 0.17992 to 0.18828, saving model to models/densenet121_emotion_model.h5
WARNING:absl:You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 

[1m30/30[0m [32m====================[0m[37m[0m [1m233s[0m 8s/step - accuracy: 0.1937 - loss: 2.4077 - top_k_categorical_accuracy: 0.8292 - val_accuracy: 0.1883 - val_loss: 1.7935 - val_top_k_categorical_accuracy: 0.8326 - learning_rate: 0.0010
Epoch 3/50

[1m 1/30[0m [37m====================[0m [1m4:45[0m 10s/step - accuracy: 0.0938 - loss: 2.9710 - top_k_categorical_accuracy: 0.6875
[1m 2/30[0m [32m=[0m[37m===================[0m [1m3:09[0m 7s/step - accuracy: 0.1172 - loss: 2.8590 - top_k_categorical_accuracy: 0.7188 
[1m 3/30[0m [32m==[0m[37m==================[0m [1m2:43[0m 6s/step - accuracy: 0.1233 - loss: 2.8062 - top_k_categorical_accuracy: 0.7500
[1m 4/30[0m [32m==[0m[37m==================[0m [1m2:37[0m 6s/step - accuracy: 0.1217 - loss: 2.8020 - top_k_categorical_accuracy: 0.7637
[1m 5/30[0m [32m===[0m[37m=================[0m [1m2:28[0m 6s/step - accuracy: 0.1186 - loss: 2.8069 - top_k_categorical_accuracy: 0.7672
[1m 6/30[0m [32m====[0m[37m================[0m [1m2:19[0m 6s/step - accuracy: 0.1154 - loss: 2.7995 - top_k_categorical_accuracy: 0.7695
[1m 7/30[0m [32m====[0m[37m================[0m [1m2:07[0m 6s/step - accuracy: 0.1174 - loss: 2.7807 - top_k_categorical_accuracy: 0.7750
[1m 8/30[0m [32m=====[0m[37m===============[0m [1m1:59[0m 5s/step - accuracy: 0.1198 - loss: 2.7574 - top_k_categorical_accuracy: 0.7807
[1m 9/30[0m [32m======[0m[37m==============[0m [1m1:54[0m 5s/step - accuracy: 0.1208 - loss: 2.7387 - top_k_categorical_accuracy: 0.7862
[1m10/30[0m [32m======[0m[37m==============[0m [1m1:49[0m 5s/step - accuracy: 0.1221 - loss: 2.7198 - top_k_categorical_accuracy: 0.7916
[1m11/30[0m [32m=======[0m[37m=============[0m [1m1:45[0m 6s/step - accuracy: 0.1232 - loss: 2.7021 - top_k_categorical_accuracy: 0.7963
[1m12/30[0m [32m========[0m[37m============[0m [1m1:40[0m 6s/step - accuracy: 0.1235 - loss: 2.6889 - top_k_categorical_accuracy: 0.8009
[1m13/30[0m [32m========[0m[37m============[0m [1m1:35[0m 6s/step - accuracy: 0.1248 - loss: 2.6762 - top_k_categorical_accuracy: 0.8041
[1m14/30[0m [32m=========[0m[37m===========[0m [1m1:29[0m 6s/step - accuracy: 0.1262 - loss: 2.6631 - top_k_categorical_accuracy: 0.8074
[1m15/30[0m [32m==========[0m[37m==========[0m [1m1:24[0m 6s/step - accuracy: 0.1275 - loss: 2.6514 - top_k_categorical_accuracy: 0.8101
[1m16/30[0m [32m==========[0m[37m==========[0m [1m1:18[0m 6s/step - accuracy: 0.1291 - loss: 2.6402 - top_k_categorical_accuracy: 0.8127
[1m17/30[0m [32m===========[0m[37m=========[0m [1m1:12[0m 6s/step - accuracy: 0.1300 - loss: 2.6316 - top_k_categorical_accuracy: 0.8144
[1m18/30[0m [32m============[0m[37m========[0m [1m1:06[0m 6s/step - accuracy: 0.1308 - loss: 2.6242 - top_k_categorical_accuracy: 0.8158
[1m19/30[0m [32m============[0m[37m========[0m [1m1:01[0m 6s/step - accuracy: 0.1314 - loss: 2.6175 - top_k_categorical_accuracy: 0.8167
[1m20/30[0m [32m=============[0m[37m=======[0m [1m55s[0m 6s/step - accuracy: 0.1319 - loss: 2.6113 - top_k_categorical_accuracy: 0.8175 
[1m21/30[0m [32m==============[0m[37m======[0m [1m50s[0m 6s/step - accuracy: 0.1322 - loss: 2.6063 - top_k_categorical_accuracy: 0.8181
[1m22/30[0m [32m==============[0m[37m======[0m [1m44s[0m 6s/step - accuracy: 0.1325 - loss: 2.6018 - top_k_categorical_accuracy: 0.8186
[1m23/30[0m [32m===============[0m[37m=====[0m [1m39s[0m 6s/step - accuracy: 0.1328 - loss: 2.5972 - top_k_categorical_accuracy: 0.8189
[1m24/30[0m [32m================[0m[37m====[0m [1m33s[0m 6s/step - accuracy: 0.1330 - loss: 2.5932 - top_k_categorical_accuracy: 0.8191
[1m25/30[0m [32m================[0m[37m====[0m [1m27s[0m 6s/step - accuracy: 0.1334 - loss: 2.5887 - top_k_categorical_accuracy: 0.8194
[1m26/30[0m [32m=================[0m[37m===[0m [1m22s[0m 6s/step - accuracy: 0.1338 - loss: 2.5846 - top_k_categorical_accuracy: 0.8197
[1m27/30[0m [32m==================[0m[37m==[0m [1m16s[0m 6s/step - accuracy: 0.1343 - loss: 2.5805 - top_k_categorical_accuracy: 0.8199
[1m28/30[0m [32m==================[0m[37m==[0m [1m11s[0m 6s/step - accuracy: 0.1348 - loss: 2.5766 - top_k_categorical_accuracy: 0.8200
[1m29/30[0m [32m===================[0m[37m=[0m [1m5s[0m 6s/step - accuracy: 0.1352 - loss: 2.5727 - top_k_categorical_accuracy: 0.8201 
[1m30/30[0m [32m====================[0m[37m[0m [1m0s[0m 6s/step - accuracy: 0.1355 - loss: 2.5690 - top_k_categorical_accuracy: 0.8203
Epoch 3: val_accuracy did not improve from 0.18828

[1m30/30[0m [32m====================[0m[37m[0m [1m217s[0m 7s/step - accuracy: 0.1448 - loss: 2.4638 - top_k_categorical_accuracy: 0.8260 - val_accuracy: 0.1632 - val_loss: 1.7988 - val_top_k_categorical_accuracy: 0.8452 - learning_rate: 0.0010
Epoch 4/50

[1m 1/30[0m [37m====================[0m [1m4:21[0m 9s/step - accuracy: 0.1250 - loss: 2.5449 - top_k_categorical_accuracy: 0.7812
[1m 2/30[0m [32m=[0m[37m===================[0m [1m2:43[0m 6s/step - accuracy: 0.1328 - loss: 2.4863 - top_k_categorical_accuracy: 0.7969
[1m 3/30[0m [32m==[0m[37m==================[0m [1m2:38[0m 6s/step - accuracy: 0.1476 - loss: 2.4344 - top_k_categorical_accuracy: 0.8021
[1m 4/30[0m [32m==[0m[37m==================[0m [1m2:32[0m 6s/step - accuracy: 0.1556 - loss: 2.4030 - top_k_categorical_accuracy: 0.8027
[1m 5/30[0m [32m===[0m[37m=================[0m [1m2:31[0m 6s/step - accuracy: 0.1595 - loss: 2.3851 - top_k_categorical_accuracy: 0.8084
[1m 6/30[0m [32m====[0m[37m================[0m [1m2:24[0m 6s/step - accuracy: 0.1624 - loss: 2.3694 - top_k_categorical_accuracy: 0.8143
[1m 7/30[0m [32m====[0m[37m================[0m [1m2:16[0m 6s/step - accuracy: 0.1647 - loss: 2.3548 - top_k_categorical_accuracy: 0.8185
[1m 8/30[0m [32m=====[0m[37m===============[0m [1m2:08[0m 6s/step - accuracy: 0.1651 - loss: 2.3503 - top_k_categorical_accuracy: 0.8202
[1m 9/30[0m [32m======[0m[37m==============[0m [1m2:01[0m 6s/step - accuracy: 0.1665 - loss: 2.3492 - top_k_categorical_accuracy: 0.8197
[1m10/30[0m [32m======[0m[37m==============[0m [1m1:55[0m 6s/step - accuracy: 0.1676 - loss: 2.3495 - top_k_categorical_accuracy: 0.8193
[1m11/30[0m [32m=======[0m[37m=============[0m [1m1:49[0m 6s/step - accuracy: 0.1689 - loss: 2.3499 - top_k_categorical_accuracy: 0.8192
[1m12/30[0m [32m========[0m[37m============[0m [1m1:43[0m 6s/step - accuracy: 0.1698 - loss: 2.3493 - top_k_categorical_accuracy: 0.8193
[1m13/30[0m [32m========[0m[37m============[0m [1m1:37[0m 6s/step - accuracy: 0.1712 - loss: 2.3471 - top_k_categorical_accuracy: 0.8201
[1m14/30[0m [32m=========[0m[37m===========[0m [1m1:31[0m 6s/step - accuracy: 0.1720 - loss: 2.3466 - top_k_categorical_accuracy: 0.8200
[1m15/30[0m [32m==========[0m[37m==========[0m [1m1:24[0m 6s/step - accuracy: 0.1722 - loss: 2.3466 - top_k_categorical_accuracy: 0.8199
[1m16/30[0m [32m==========[0m[37m==========[0m [1m1:19[0m 6s/step - accuracy: 0.1726 - loss: 2.3454 - top_k_categorical_accuracy: 0.8198
[1m17/30[0m [32m===========[0m[37m=========[0m [1m1:14[0m 6s/step - accuracy: 0.1727 - loss: 2.3449 - top_k_categorical_accuracy: 0.8198
[1m18/30[0m [32m============[0m[37m========[0m [1m1:08[0m 6s/step - accuracy: 0.1728 - loss: 2.3446 - top_k_categorical_accuracy: 0.8200
[1m19/30[0m [32m============[0m[37m========[0m [1m1:02[0m 6s/step - accuracy: 0.1731 - loss: 2.3439 - top_k_categorical_accuracy: 0.8200
[1m20/30[0m [32m=============[0m[37m=======[0m [1m57s[0m 6s/step - accuracy: 0.1736 - loss: 2.3426 - top_k_categorical_accuracy: 0.8201 
[1m21/30[0m [32m==============[0m[37m======[0m [1m51s[0m 6s/step - accuracy: 0.1739 - loss: 2.3416 - top_k_categorical_accuracy: 0.8201
[1m22/30[0m [32m==============[0m[37m======[0m [1m45s[0m 6s/step - accuracy: 0.1742 - loss: 2.3407 - top_k_categorical_accuracy: 0.8201
[1m23/30[0m [32m===============[0m[37m=====[0m [1m40s[0m 6s/step - accuracy: 0.1745 - loss: 2.3396 - top_k_categorical_accuracy: 0.8202
[1m24/30[0m [32m================[0m[37m====[0m [1m34s[0m 6s/step - accuracy: 0.1747 - loss: 2.3389 - top_k_categorical_accuracy: 0.8201
[1m25/30[0m [32m================[0m[37m====[0m [1m28s[0m 6s/step - accuracy: 0.1748 - loss: 2.3388 - top_k_categorical_accuracy: 0.8201
[1m26/30[0m [32m=================[0m[37m===[0m [1m23s[0m 6s/step - accuracy: 0.1752 - loss: 2.3381 - top_k_categorical_accuracy: 0.8203
[1m27/30[0m [32m==================[0m[37m==[0m [1m17s[0m 6s/step - accuracy: 0.1756 - loss: 2.3370 - top_k_categorical_accuracy: 0.8205
[1m28/30[0m [32m==================[0m[37m==[0m [1m11s[0m 6s/step - accuracy: 0.1760 - loss: 2.3361 - top_k_categorical_accuracy: 0.8206
[1m29/30[0m [32m===================[0m[37m=[0m [1m5s[0m 6s/step - accuracy: 0.1763 - loss: 2.3351 - top_k_categorical_accuracy: 0.8207 
[1m30/30[0m [32m====================[0m[37m[0m [1m0s[0m 6s/step - accuracy: 0.1767 - loss: 2.3341 - top_k_categorical_accuracy: 0.8209
Epoch 4: val_accuracy did not improve from 0.18828

[1m30/30[0m [32m====================[0m[37m[0m [1m206s[0m 7s/step - accuracy: 0.1875 - loss: 2.3036 - top_k_categorical_accuracy: 0.8250 - val_accuracy: 0.1883 - val_loss: 1.8193 - val_top_k_categorical_accuracy: 0.8326 - learning_rate: 0.0010
Epoch 5/50

[1m 1/30[0m [37m====================[0m [1m2:59[0m 6s/step - accuracy: 0.0938 - loss: 2.5553 - top_k_categorical_accuracy: 0.7500
[1m 2/30[0m [32m=[0m[37m===================[0m [1m1:40[0m 4s/step - accuracy: 0.1250 - loss: 2.4512 - top_k_categorical_accuracy: 0.7734
[1m 3/30[0m [32m==[0m[37m==================[0m [1m1:48[0m 4s/step - accuracy: 0.1424 - loss: 2.3971 - top_k_categorical_accuracy: 0.7865
[1m 4/30[0m [32m==[0m[37m==================[0m [1m1:44[0m 4s/step - accuracy: 0.1478 - loss: 2.3964 - top_k_categorical_accuracy: 0.7910
[1m 5/30[0m [32m===[0m[37m=================[0m [1m1:39[0m 4s/step - accuracy: 0.1520 - loss: 2.3826 - top_k_categorical_accuracy: 0.7991
[1m 6/30[0m [32m====[0m[37m================[0m [1m1:38[0m 4s/step - accuracy: 0.1536 - loss: 2.3788 - top_k_categorical_accuracy: 0.8030
[1m 7/30[0m [32m====[0m[37m================[0m [1m1:39[0m 4s/step - accuracy: 0.1565 - loss: 2.3694 - top_k_categorical_accuracy: 0.8063
[1m 8/30[0m [32m=====[0m[37m===============[0m [1m1:40[0m 5s/step - accuracy: 0.1574 - loss: 2.3662 - top_k_categorical_accuracy: 0.8081
[1m 9/30[0m [32m======[0m[37m==============[0m [1m1:40[0m 5s/step - accuracy: 0.1577 - loss: 2.3674 - top_k_categorical_accuracy: 0.8082
[1m10/30[0m [32m======[0m[37m==============[0m [1m1:38[0m 5s/step - accuracy: 0.1582 - loss: 2.3654 - top_k_categorical_accuracy: 0.8098
[1m11/30[0m [32m=======[0m[37m=============[0m [1m1:36[0m 5s/step - accuracy: 0.1577 - loss: 2.3634 - top_k_categorical_accuracy: 0.8116
[1m12/30[0m [32m========[0m[37m============[0m [1m1:33[0m 5s/step - accuracy: 0.1574 - loss: 2.3604 - top_k_categorical_accuracy: 0.8137
[1m13/30[0m [32m========[0m[37m============[0m [1m1:30[0m 5s/step - accuracy: 0.1577 - loss: 2.3576 - top_k_categorical_accuracy: 0.8156
[1m14/30[0m [32m=========[0m[37m===========[0m [1m1:26[0m 5s/step - accuracy: 0.1589 - loss: 2.3538 - top_k_categorical_accuracy: 0.8176
[1m15/30[0m [32m==========[0m[37m==========[0m [1m1:21[0m 5s/step - accuracy: 0.1595 - loss: 2.3509 - top_k_categorical_accuracy: 0.8191
[1m16/30[0m [32m==========[0m[37m==========[0m [1m1:15[0m 5s/step - accuracy: 0.1597 - loss: 2.3488 - top_k_categorical_accuracy: 0.8200
[1m17/30[0m [32m===========[0m[37m=========[0m [1m1:10[0m 5s/step - accuracy: 0.1598 - loss: 2.3474 - top_k_categorical_accuracy: 0.8209
[1m18/30[0m [32m============[0m[37m========[0m [1m1:05[0m 5s/step - accuracy: 0.1600 - loss: 2.3456 - top_k_categorical_accuracy: 0.8218
[1m19/30[0m [32m============[0m[37m========[0m [1m59s[0m 5s/step - accuracy: 0.1601 - loss: 2.3435 - top_k_categorical_accuracy: 0.8227 
[1m20/30[0m [32m=============[0m[37m=======[0m [1m54s[0m 5s/step - accuracy: 0.1601 - loss: 2.3411 - top_k_categorical_accuracy: 0.8232
[1m21/30[0m [32m==============[0m[37m======[0m [1m49s[0m 6s/step - accuracy: 0.1599 - loss: 2.3392 - top_k_categorical_accuracy: 0.8233
[1m22/30[0m [32m==============[0m[37m======[0m [1m44s[0m 6s/step - accuracy: 0.1596 - loss: 2.3382 - top_k_categorical_accuracy: 0.8233
[1m23/30[0m [32m===============[0m[37m=====[0m [1m38s[0m 5s/step - accuracy: 0.1595 - loss: 2.3371 - top_k_categorical_accuracy: 0.8233
[1m24/30[0m [32m================[0m[37m====[0m [1m32s[0m 5s/step - accuracy: 0.1594 - loss: 2.3359 - top_k_categorical_accuracy: 0.8234
[1m25/30[0m [32m================[0m[37m====[0m [1m26s[0m 5s/step - accuracy: 0.1592 - loss: 2.3346 - top_k_categorical_accuracy: 0.8235
[1m26/30[0m [32m=================[0m[37m===[0m [1m21s[0m 5s/step - accuracy: 0.1590 - loss: 2.3335 - top_k_categorical_accuracy: 0.8236
[1m27/30[0m [32m==================[0m[37m==[0m [1m15s[0m 5s/step - accuracy: 0.1587 - loss: 2.3329 - top_k_categorical_accuracy: 0.8236
[1m28/30[0m [32m==================[0m[37m==[0m [1m10s[0m 5s/step - accuracy: 0.1585 - loss: 2.3316 - top_k_categorical_accuracy: 0.8237
[1m29/30[0m [32m===================[0m[37m=[0m [1m5s[0m 5s/step - accuracy: 0.1583 - loss: 2.3305 - top_k_categorical_accuracy: 0.8238 
[1m30/30[0m [32m====================[0m[37m[0m [1m0s[0m 5s/step - accuracy: 0.1581 - loss: 2.3294 - top_k_categorical_accuracy: 0.8238
Epoch 5: val_accuracy did not improve from 0.18828

[1m30/30[0m [32m====================[0m[37m[0m [1m205s[0m 7s/step - accuracy: 0.1531 - loss: 2.2973 - top_k_categorical_accuracy: 0.8250 - val_accuracy: 0.1715 - val_loss: 1.8265 - val_top_k_categorical_accuracy: 0.8326 - learning_rate: 0.0010
Epoch 6/50

[1m 1/30[0m [37m====================[0m [1m32:03[0m 66s/step - accuracy: 0.2500 - loss: 1.9098 - top_k_categorical_accuracy: 0.8750
[1m 2/30[0m [32m=[0m[37m===================[0m [1m2:34[0m 6s/step - accuracy: 0.2188 - loss: 2.0364 - top_k_categorical_accuracy: 0.8828  
[1m 3/30[0m [32m==[0m[37m==================[0m [1m2:35[0m 6s/step - accuracy: 0.2049 - loss: 2.0804 - top_k_categorical_accuracy: 0.8837
[1m 4/30[0m [32m==[0m[37m==================[0m [1m2:27[0m 6s/step - accuracy: 0.1927 - loss: 2.1118 - top_k_categorical_accuracy: 0.8854
[1m 5/30[0m [32m===[0m[37m=================[0m [1m2:21[0m 6s/step - accuracy: 0.1879 - loss: 2.1270 - top_k_categorical_accuracy: 0.8833
[1m 6/30[0m [32m====[0m[37m================[0m [1m2:16[0m 6s/step - accuracy: 0.1852 - loss: 2.1330 - top_k_categorical_accuracy: 0.8828
[1m 7/30[0m [32m====[0m[37m================[0m [1m2:13[0m 6s/step - accuracy: 0.1830 - loss: 2.1343 - top_k_categorical_accuracy: 0.8823
[1m 8/30[0m [32m=====[0m[37m===============[0m [1m2:10[0m 6s/step - accuracy: 0.1816 - loss: 2.1359 - top_k_categorical_accuracy: 0.8814
[1m 9/30[0m [32m======[0m[37m==============[0m [1m2:05[0m 6s/step - accuracy: 0.1823 - loss: 2.1344 - top_k_categorical_accuracy: 0.8811
[1m10/30[0m [32m======[0m[37m==============[0m [1m1:58[0m 6s/step - accuracy: 0.1822 - loss: 2.1338 - top_k_categorical_accuracy: 0.8805
[1m11/30[0m [32m=======[0m[37m=============[0m [1m1:52[0m 6s/step - accuracy: 0.1814 - loss: 2.1361 - top_k_categorical_accuracy: 0.8795
[1m12/30[0m [32m========[0m[37m============[0m [1m1:45[0m 6s/step - accuracy: 0.1801 - loss: 2.1394 - top_k_categorical_accuracy: 0.8782
[1m13/30[0m [32m========[0m[37m============[0m [1m1:40[0m 6s/step - accuracy: 0.1787 - loss: 2.1428 - top_k_categorical_accuracy: 0.8771
[1m14/30[0m [32m=========[0m[37m===========[0m [1m1:34[0m 6s/step - accuracy: 0.1775 - loss: 2.1461 - top_k_categorical_accuracy: 0.8758
[1m15/30[0m [32m==========[0m[37m==========[0m [1m1:27[0m 6s/step - accuracy: 0.1764 - loss: 2.1486 - top_k_categorical_accuracy: 0.8748
[1m16/30[0m [32m==========[0m[37m==========[0m [1m1:21[0m 6s/step - accuracy: 0.1756 - loss: 2.1499 - top_k_categorical_accuracy: 0.8737
[1m17/30[0m [32m===========[0m[37m=========[0m [1m1:15[0m 6s/step - accuracy: 0.1748 - loss: 2.1517 - top_k_categorical_accuracy: 0.8725
[1m18/30[0m [32m============[0m[37m========[0m [1m1:11[0m 6s/step - accuracy: 0.1739 - loss: 2.1539 - top_k_categorical_accuracy: 0.8713
[1m19/30[0m [32m============[0m[37m========[0m [1m1:04[0m 6s/step - accuracy: 0.1733 - loss: 2.1557 - top_k_categorical_accuracy: 0.8703
[1m20/30[0m [32m=============[0m[37m=======[0m [1m58s[0m 6s/step - accuracy: 0.1727 - loss: 2.1566 - top_k_categorical_accuracy: 0.8697 
[1m21/30[0m [32m==============[0m[37m======[0m [1m52s[0m 6s/step - accuracy: 0.1720 - loss: 2.1576 - top_k_categorical_accuracy: 0.8691
[1m22/30[0m [32m==============[0m[37m======[0m [1m46s[0m 6s/step - accuracy: 0.1714 - loss: 2.1585 - top_k_categorical_accuracy: 0.8686
[1m23/30[0m [32m===============[0m[37m=====[0m [1m40s[0m 6s/step - accuracy: 0.1709 - loss: 2.1594 - top_k_categorical_accuracy: 0.8680
[1m24/30[0m [32m================[0m[37m====[0m [1m34s[0m 6s/step - accuracy: 0.1703 - loss: 2.1602 - top_k_categorical_accuracy: 0.8675
[1m25/30[0m [32m================[0m[37m====[0m [1m28s[0m 6s/step - accuracy: 0.1697 - loss: 2.1614 - top_k_categorical_accuracy: 0.8668
[1m26/30[0m [32m=================[0m[37m===[0m [1m23s[0m 6s/step - accuracy: 0.1691 - loss: 2.1626 - top_k_categorical_accuracy: 0.8661
[1m27/30[0m [32m==================[0m[37m==[0m [1m17s[0m 6s/step - accuracy: 0.1686 - loss: 2.1638 - top_k_categorical_accuracy: 0.8654
[1m28/30[0m [32m==================[0m[37m==[0m [1m11s[0m 6s/step - accuracy: 0.1681 - loss: 2.1648 - top_k_categorical_accuracy: 0.8646
[1m29/30[0m [32m===================[0m[37m=[0m [1m5s[0m 6s/step - accuracy: 0.1677 - loss: 2.1656 - top_k_categorical_accuracy: 0.8639 
[1m30/30[0m [32m====================[0m[37m[0m [1m0s[0m 6s/step - accuracy: 0.1674 - loss: 2.1663 - top_k_categorical_accuracy: 0.8633
Epoch 6: val_accuracy did not improve from 0.18828

[1m30/30[0m [32m====================[0m[37m[0m [1m276s[0m 7s/step - accuracy: 0.1583 - loss: 2.1861 - top_k_categorical_accuracy: 0.8448 - val_accuracy: 0.1883 - val_loss: 1.8383 - val_top_k_categorical_accuracy: 0.8326 - learning_rate: 0.0010
Epoch 7/50

[1m 1/30[0m [37m====================[0m [1m5:15[0m 11s/step - accuracy: 0.1562 - loss: 2.3160 - top_k_categorical_accuracy: 0.7500
[1m 2/30[0m [32m=[0m[37m===================[0m [1m2:38[0m 6s/step - accuracy: 0.1406 - loss: 2.3459 - top_k_categorical_accuracy: 0.7422 
[1m 3/30[0m [32m==[0m[37m==================[0m [1m2:32[0m 6s/step - accuracy: 0.1354 - loss: 2.3333 - top_k_categorical_accuracy: 0.7517
[1m 4/30[0m [32m==[0m[37m==================[0m [1m2:27[0m 6s/step - accuracy: 0.1367 - loss: 2.3091 - top_k_categorical_accuracy: 0.7650
[1m 5/30[0m [32m===[0m[37m=================[0m [1m2:13[0m 5s/step - accuracy: 0.1381 - loss: 2.2840 - top_k_categorical_accuracy: 0.7770
[1m 6/30[0m [32m====[0m[37m================[0m [1m2:00[0m 5s/step - accuracy: 0.1377 - loss: 2.2766 - top_k_categorical_accuracy: 0.7829
[1m 7/30[0m [32m====[0m[37m================[0m [1m1:52[0m 5s/step - accuracy: 0.1378 - loss: 2.2652 - top_k_categorical_accuracy: 0.7878
[1m 8/30[0m [32m=====[0m[37m===============[0m [1m1:48[0m 5s/step - accuracy: 0.1367 - loss: 2.2579 - top_k_categorical_accuracy: 0.7913
[1m 9/30[0m [32m======[0m[37m==============[0m [1m1:45[0m 5s/step - accuracy: 0.1350 - loss: 2.2516 - top_k_categorical_accuracy: 0.7945
[1m10/30[0m [32m======[0m[37m==============[0m [1m1:41[0m 5s/step - accuracy: 0.1346 - loss: 2.2434 - top_k_categorical_accuracy: 0.7981
[1m11/30[0m [32m=======[0m[37m=============[0m [1m1:38[0m 5s/step - accuracy: 0.1340 - loss: 2.2361 - top_k_categorical_accuracy: 0.8013
[1m12/30[0m [32m========[0m[37m============[0m [1m1:34[0m 5s/step - accuracy: 0.1350 - loss: 2.2273 - top_k_categorical_accuracy: 0.8046
[1m13/30[0m [32m========[0m[37m============[0m [1m1:30[0m 5s/step - accuracy: 0.1362 - loss: 2.2196 - top_k_categorical_accuracy: 0.8078
[1m14/30[0m [32m=========[0m[37m===========[0m [1m1:26[0m 5s/step - accuracy: 0.1377 - loss: 2.2122 - top_k_categorical_accuracy: 0.8103
[1m15/30[0m [32m==========[0m[37m==========[0m [1m1:22[0m 5s/step - accuracy: 0.1395 - loss: 2.2046 - top_k_categorical_accuracy: 0.8129
[1m16/30[0m [32m==========[0m[37m==========[0m [1m1:16[0m 5s/step - accuracy: 0.1410 - loss: 2.1984 - top_k_categorical_accuracy: 0.8152
[1m17/30[0m [32m===========[0m[37m=========[0m [1m1:11[0m 6s/step - accuracy: 0.1427 - loss: 2.1924 - top_k_categorical_accuracy: 0.8172
[1m18/30[0m [32m============[0m[37m========[0m [1m1:06[0m 6s/step - accuracy: 0.1443 - loss: 2.1870 - top_k_categorical_accuracy: 0.8190
[1m19/30[0m [32m============[0m[37m========[0m [1m1:00[0m 6s/step - accuracy: 0.1458 - loss: 2.1822 - top_k_categorical_accuracy: 0.8207
[1m20/30[0m [32m=============[0m[37m=======[0m [1m55s[0m 6s/step - accuracy: 0.1472 - loss: 2.1779 - top_k_categorical_accuracy: 0.8221 
[1m21/30[0m [32m==============[0m[37m======[0m [1m50s[0m 6s/step - accuracy: 0.1484 - loss: 2.1742 - top_k_categorical_accuracy: 0.8233
[1m22/30[0m [32m==============[0m[37m======[0m [1m45s[0m 6s/step - accuracy: 0.1494 - loss: 2.1707 - top_k_categorical_accuracy: 0.8244
[1m23/30[0m [32m===============[0m[37m=====[0m [1m39s[0m 6s/step - accuracy: 0.1502 - loss: 2.1679 - top_k_categorical_accuracy: 0.8253
[1m24/30[0m [32m================[0m[37m====[0m [1m33s[0m 6s/step - accuracy: 0.1510 - loss: 2.1651 - top_k_categorical_accuracy: 0.8260
[1m25/30[0m [32m================[0m[37m====[0m [1m28s[0m 6s/step - accuracy: 0.1518 - loss: 2.1628 - top_k_categorical_accuracy: 0.8266
[1m26/30[0m [32m=================[0m[37m===[0m [1m22s[0m 6s/step - accuracy: 0.1527 - loss: 2.1605 - top_k_categorical_accuracy: 0.8274
[1m27/30[0m [32m==================[0m[37m==[0m [1m16s[0m 6s/step - accuracy: 0.1535 - loss: 2.1586 - top_k_categorical_accuracy: 0.8280
[1m28/30[0m [32m==================[0m[37m==[0m [1m11s[0m 6s/step - accuracy: 0.1542 - loss: 2.1568 - top_k_categorical_accuracy: 0.8286
[1m29/30[0m [32m===================[0m[37m=[0m [1m5s[0m 5s/step - accuracy: 0.1550 - loss: 2.1549 - top_k_categorical_accuracy: 0.8290 
[1m30/30[0m [32m====================[0m[37m[0m [1m0s[0m 5s/step - accuracy: 0.1559 - loss: 2.1530 - top_k_categorical_accuracy: 0.8293
Epoch 7: val_accuracy improved from 0.18828 to 0.20502, saving model to models/densenet121_emotion_model.h5
WARNING:absl:You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 

Epoch 7: ReduceLROnPlateau reducing learning rate to 0.0005000000237487257.

[1m30/30[0m [32m====================[0m[37m[0m [1m204s[0m 7s/step - accuracy: 0.1802 - loss: 2.0983 - top_k_categorical_accuracy: 0.8385 - val_accuracy: 0.2050 - val_loss: 1.8101 - val_top_k_categorical_accuracy: 0.8410 - learning_rate: 0.0010
Epoch 8/50

[1m 1/30[0m [37m====================[0m [1m2:53[0m 6s/step - accuracy: 0.1562 - loss: 1.9096 - top_k_categorical_accuracy: 0.8750
[1m 2/30[0m [32m=[0m[37m===================[0m [1m1:52[0m 4s/step - accuracy: 0.1562 - loss: 1.9691 - top_k_categorical_accuracy: 0.8281
[1m 3/30[0m [32m==[0m[37m==================[0m [1m1:43[0m 4s/step - accuracy: 0.1667 - loss: 1.9756 - top_k_categorical_accuracy: 0.8333
[1m 4/30[0m [32m==[0m[37m==================[0m [1m1:38[0m 4s/step - accuracy: 0.1699 - loss: 1.9884 - top_k_categorical_accuracy: 0.8281
[1m 5/30[0m [32m===[0m[37m=================[0m [1m1:34[0m 4s/step - accuracy: 0.1709 - loss: 2.0036 - top_k_categorical_accuracy: 0.8237
[1m 6/30[0m [32m====[0m[37m================[0m [1m1:31[0m 4s/step - accuracy: 0.1694 - loss: 2.0177 - top_k_categorical_accuracy: 0.8210
[1m 7/30[0m [32m====[0m[37m================[0m [1m1:27[0m 4s/step - accuracy: 0.1700 - loss: 2.0314 - top_k_categorical_accuracy: 0.8185
[1m 8/30[0m [32m=====[0m[37m===============[0m [1m1:23[0m 4s/step - accuracy: 0.1703 - loss: 2.0375 - top_k_categorical_accuracy: 0.8178
[1m 9/30[0m [32m======[0m[37m==============[0m [1m1:19[0m 4s/step - accuracy: 0.1710 - loss: 2.0407 - top_k_categorical_accuracy: 0.8172
[1m10/30[0m [32m======[0m[37m==============[0m [1m1:18[0m 4s/step - accuracy: 0.1711 - loss: 2.0449 - top_k_categorical_accuracy: 0.8161
[1m11/30[0m [32m=======[0m[37m=============[0m [1m1:13[0m 4s/step - accuracy: 0.1708 - loss: 2.0487 - top_k_categorical_accuracy: 0.8152
[1m12/30[0m [32m========[0m[37m============[0m [1m1:08[0m 4s/step - accuracy: 0.1702 - loss: 2.0520 - top_k_categorical_accuracy: 0.8148
[1m13/30[0m [32m========[0m[37m============[0m [1m1:04[0m 4s/step - accuracy: 0.1699 - loss: 2.0548 - top_k_categorical_accuracy: 0.8150
[1m14/30[0m [32m=========[0m[37m===========[0m [1m58s[0m 4s/step - accuracy: 0.1688 - loss: 2.0573 - top_k_categorical_accuracy: 0.8156 
[1m15/30[0m [32m==========[0m[37m==========[0m [1m53s[0m 4s/step - accuracy: 0.1678 - loss: 2.0587 - top_k_categorical_accuracy: 0.8162
[1m16/30[0m [32m==========[0m[37m==========[0m [1m50s[0m 4s/step - accuracy: 0.1666 - loss: 2.0611 - top_k_categorical_accuracy: 0.8166
[1m17/30[0m [32m===========[0m[37m=========[0m [1m46s[0m 4s/step - accuracy: 0.1655 - loss: 2.0639 - top_k_categorical_accuracy: 0.8167
[1m18/30[0m [32m============[0m[37m========[0m [1m43s[0m 4s/step - accuracy: 0.1644 - loss: 2.0669 - top_k_categorical_accuracy: 0.8168
[1m19/30[0m [32m============[0m[37m========[0m [1m39s[0m 4s/step - accuracy: 0.1639 - loss: 2.0684 - top_k_categorical_accuracy: 0.8172
[1m20/30[0m [32m=============[0m[37m=======[0m [1m36s[0m 4s/step - accuracy: 0.1635 - loss: 2.0697 - top_k_categorical_accuracy: 0.8172
[1m21/30[0m [32m==============[0m[37m======[0m [1m32s[0m 4s/step - accuracy: 0.1633 - loss: 2.0707 - top_k_categorical_accuracy: 0.8173
[1m22/30[0m [32m==============[0m[37m======[0m [1m29s[0m 4s/step - accuracy: 0.1633 - loss: 2.0712 - top_k_categorical_accuracy: 0.8175
[1m23/30[0m [32m===============[0m[37m=====[0m [1m25s[0m 4s/step - accuracy: 0.1632 - loss: 2.0717 - top_k_categorical_accuracy: 0.8175
[1m24/30[0m [32m================[0m[37m====[0m [1m22s[0m 4s/step - accuracy: 0.1630 - loss: 2.0726 - top_k_categorical_accuracy: 0.8176
[1m25/30[0m [32m================[0m[37m====[0m [1m18s[0m 4s/step - accuracy: 0.1629 - loss: 2.0733 - top_k_categorical_accuracy: 0.8177
[1m26/30[0m [32m=================[0m[37m===[0m [1m14s[0m 4s/step - accuracy: 0.1628 - loss: 2.0736 - top_k_categorical_accuracy: 0.8179
[1m27/30[0m [32m==================[0m[37m==[0m [1m11s[0m 4s/step - accuracy: 0.1628 - loss: 2.0736 - top_k_categorical_accuracy: 0.8183
[1m28/30[0m [32m==================[0m[37m==[0m [1m7s[0m 4s/step - accuracy: 0.1628 - loss: 2.0737 - top_k_categorical_accuracy: 0.8187 
[1m29/30[0m [32m===================[0m[37m=[0m [1m3s[0m 4s/step - accuracy: 0.1628 - loss: 2.0736 - top_k_categorical_accuracy: 0.8190
[1m30/30[0m [32m====================[0m[37m[0m [1m0s[0m 4s/step - accuracy: 0.1628 - loss: 2.0737 - top_k_categorical_accuracy: 0.8193
Epoch 8: val_accuracy did not improve from 0.20502

[1m30/30[0m [32m====================[0m[37m[0m [1m145s[0m 5s/step - accuracy: 0.1635 - loss: 2.0757 - top_k_categorical_accuracy: 0.8292 - val_accuracy: 0.1674 - val_loss: 1.7934 - val_top_k_categorical_accuracy: 0.8410 - learning_rate: 5.0000e-04
Epoch 9/50

[1m 1/30[0m [37m====================[0m [1m2:38[0m 5s/step - accuracy: 0.2188 - loss: 1.9973 - top_k_categorical_accuracy: 0.7812
[1m 2/30[0m [32m=[0m[37m===================[0m [1m1:50[0m 4s/step - accuracy: 0.2031 - loss: 2.0392 - top_k_categorical_accuracy: 0.7969
[1m 3/30[0m [32m==[0m[37m==================[0m [1m1:55[0m 4s/step - accuracy: 0.1875 - loss: 2.0689 - top_k_categorical_accuracy: 0.8056
[1m 4/30[0m [32m==[0m[37m==================[0m [1m1:59[0m 5s/step - accuracy: 0.1836 - loss: 2.0785 - top_k_categorical_accuracy: 0.8112
[1m 5/30[0m [32m===[0m[37m=================[0m [1m2:01[0m 5s/step - accuracy: 0.1844 - loss: 2.0765 - top_k_categorical_accuracy: 0.8177
[1m 6/30[0m [32m====[0m[37m================[0m [1m2:02[0m 5s/step - accuracy: 0.1849 - loss: 2.0685 - top_k_categorical_accuracy: 0.8212
[1m 7/30[0m [32m====[0m[37m================[0m [1m1:57[0m 5s/step - accuracy: 0.1865 - loss: 2.0655 - top_k_categorical_accuracy: 0.8238
[1m 8/30[0m [32m=====[0m[37m===============[0m [1m1:56[0m 5s/step - accuracy: 0.1857 - loss: 2.0677 - top_k_categorical_accuracy: 0.8248
[1m 9/30[0m [32m======[0m[37m==============[0m [1m1:52[0m 5s/step - accuracy: 0.1855 - loss: 2.0695 - top_k_categorical_accuracy: 0.8254
[1m10/30[0m [32m======[0m[37m==============[0m [1m1:49[0m 5s/step - accuracy: 0.1851 - loss: 2.0712 - top_k_categorical_accuracy: 0.8250
[1m11/30[0m [32m=======[0m[37m=============[0m [1m1:45[0m 6s/step - accuracy: 0.1848 - loss: 2.0725 - top_k_categorical_accuracy: 0.8254
[1m12/30[0m [32m========[0m[37m============[0m [1m1:41[0m 6s/step - accuracy: 0.1848 - loss: 2.0735 - top_k_categorical_accuracy: 0.8254
[1m13/30[0m [32m========[0m[37m============[0m [1m1:37[0m 6s/step - accuracy: 0.1844 - loss: 2.0737 - top_k_categorical_accuracy: 0.8261
[1m14/30[0m [32m=========[0m[37m===========[0m [1m1:31[0m 6s/step - accuracy: 0.1842 - loss: 2.0735 - top_k_categorical_accuracy: 0.8269
[1m15/30[0m [32m==========[0m[37m==========[0m [1m1:23[0m 6s/step - accuracy: 0.1845 - loss: 2.0721 - top_k_categorical_accuracy: 0.8277
[1m16/30[0m [32m==========[0m[37m==========[0m [1m1:17[0m 6s/step - accuracy: 0.1852 - loss: 2.0707 - top_k_categorical_accuracy: 0.8286
[1m17/30[0m [32m===========[0m[37m=========[0m [1m1:12[0m 6s/step - accuracy: 0.1861 - loss: 2.0687 - top_k_categorical_accuracy: 0.8295
[1m18/30[0m [32m============[0m[37m========[0m [1m1:07[0m 6s/step - accuracy: 0.1866 - loss: 2.0672 - top_k_categorical_accuracy: 0.8304
[1m19/30[0m [32m============[0m[37m========[0m [1m1:02[0m 6s/step - accuracy: 0.1869 - loss: 2.0668 - top_k_categorical_accuracy: 0.8311
[1m20/30[0m [32m=============[0m[37m=======[0m [1m57s[0m 6s/step - accuracy: 0.1870 - loss: 2.0669 - top_k_categorical_accuracy: 0.8316 
[1m21/30[0m [32m==============[0m[37m======[0m [1m52s[0m 6s/step - accuracy: 0.1869 - loss: 2.0676 - top_k_categorical_accuracy: 0.8320
[1m22/30[0m [32m==============[0m[37m======[0m [1m46s[0m 6s/step - accuracy: 0.1866 - loss: 2.0682 - top_k_categorical_accuracy: 0.8326
[1m23/30[0m [32m===============[0m[37m=====[0m [1m40s[0m 6s/step - accuracy: 0.1861 - loss: 2.0685 - top_k_categorical_accuracy: 0.8331
[1m24/30[0m [32m================[0m[37m====[0m [1m35s[0m 6s/step - accuracy: 0.1859 - loss: 2.0685 - top_k_categorical_accuracy: 0.8336
[1m25/30[0m [32m================[0m[37m====[0m [1m29s[0m 6s/step - accuracy: 0.1856 - loss: 2.0684 - top_k_categorical_accuracy: 0.8340
[1m26/30[0m [32m=================[0m[37m===[0m [1m23s[0m 6s/step - accuracy: 0.1856 - loss: 2.0683 - top_k_categorical_accuracy: 0.8345
[1m27/30[0m [32m==================[0m[37m==[0m [1m17s[0m 6s/step - accuracy: 0.1856 - loss: 2.0679 - top_k_categorical_accuracy: 0.8350
[1m28/30[0m [32m==================[0m[37m==[0m [1m11s[0m 6s/step - accuracy: 0.1856 - loss: 2.0676 - top_k_categorical_accuracy: 0.8353
[1m29/30[0m [32m===================[0m[37m=[0m [1m5s[0m 6s/step - accuracy: 0.1854 - loss: 2.0672 - top_k_categorical_accuracy: 0.8356 
[1m30/30[0m [32m====================[0m[37m[0m [1m0s[0m 6s/step - accuracy: 0.1852 - loss: 2.0670 - top_k_categorical_accuracy: 0.8358
Epoch 9: val_accuracy improved from 0.20502 to 0.21339, saving model to models/densenet121_emotion_model.h5
WARNING:absl:You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 

[1m30/30[0m [32m====================[0m[37m[0m [1m239s[0m 8s/step - accuracy: 0.1813 - loss: 2.0604 - top_k_categorical_accuracy: 0.8417 - val_accuracy: 0.2134 - val_loss: 1.7773 - val_top_k_categorical_accuracy: 0.8494 - learning_rate: 5.0000e-04
Epoch 10/50

[1m 1/30[0m [37m====================[0m [1m4:38[0m 10s/step - accuracy: 0.1562 - loss: 2.0815 - top_k_categorical_accuracy: 0.7812
[1m 2/30[0m [32m=[0m[37m===================[0m [1m3:06[0m 7s/step - accuracy: 0.1328 - loss: 2.0778 - top_k_categorical_accuracy: 0.7969 
[1m 3/30[0m [32m==[0m[37m==================[0m [1m3:11[0m 7s/step - accuracy: 0.1198 - loss: 2.0968 - top_k_categorical_accuracy: 0.8021
[1m 4/30[0m [32m==[0m[37m==================[0m [1m2:56[0m 7s/step - accuracy: 0.1191 - loss: 2.0950 - top_k_categorical_accuracy: 0.8125
[1m 5/30[0m [32m===[0m[37m=================[0m [1m2:45[0m 7s/step - accuracy: 0.1191 - loss: 2.1030 - top_k_categorical_accuracy: 0.8150
[1m 6/30[0m [32m====[0m[37m================[0m [1m2:28[0m 6s/step - accuracy: 0.1192 - loss: 2.1046 - top_k_categorical_accuracy: 0.8181
[1m 7/30[0m [32m====[0m[37m================[0m [1m2:14[0m 6s/step - accuracy: 0.1207 - loss: 2.1030 - top_k_categorical_accuracy: 0.8224
[1m 8/30[0m [32m=====[0m[37m===============[0m [1m2:04[0m 6s/step - accuracy: 0.1222 - loss: 2.1001 - top_k_categorical_accuracy: 0.8250
[1m 9/30[0m [32m======[0m[37m==============[0m [1m1:55[0m 5s/step - accuracy: 0.1229 - loss: 2.0960 - top_k_categorical_accuracy: 0.8271
[1m10/30[0m [32m======[0m[37m==============[0m [1m1:47[0m 5s/step - accuracy: 0.1243 - loss: 2.0911 - top_k_categorical_accuracy: 0.8288
[1m11/30[0m [32m=======[0m[37m=============[0m [1m1:40[0m 5s/step - accuracy: 0.1257 - loss: 2.0878 - top_k_categorical_accuracy: 0.8304
[1m12/30[0m [32m========[0m[37m============[0m [1m1:33[0m 5s/step - accuracy: 0.1278 - loss: 2.0833 - top_k_categorical_accuracy: 0.8324
[1m13/30[0m [32m========[0m[37m============[0m [1m1:26[0m 5s/step - accuracy: 0.1307 - loss: 2.0788 - top_k_categorical_accuracy: 0.8338
[1m14/30[0m [32m=========[0m[37m===========[0m [1m1:21[0m 5s/step - accuracy: 0.1332 - loss: 2.0753 - top_k_categorical_accuracy: 0.8348
[1m15/30[0m [32m==========[0m[37m==========[0m [1m1:15[0m 5s/step - accuracy: 0.1354 - loss: 2.0721 - top_k_categorical_accuracy: 0.8357
[1m16/30[0m [32m==========[0m[37m==========[0m [1m1:10[0m 5s/step - accuracy: 0.1375 - loss: 2.0698 - top_k_categorical_accuracy: 0.8361
[1m17/30[0m [32m===========[0m[37m=========[0m [1m1:04[0m 5s/step - accuracy: 0.1395 - loss: 2.0674 - top_k_categorical_accuracy: 0.8364
[1m18/30[0m [32m============[0m[37m========[0m [1m59s[0m 5s/step - accuracy: 0.1410 - loss: 2.0656 - top_k_categorical_accuracy: 0.8368 
[1m19/30[0m [32m============[0m[37m========[0m [1m55s[0m 5s/step - accuracy: 0.1424 - loss: 2.0640 - top_k_categorical_accuracy: 0.8369
[1m20/30[0m [32m=============[0m[37m=======[0m [1m50s[0m 5s/step - accuracy: 0.1438 - loss: 2.0626 - top_k_categorical_accuracy: 0.8370
[1m21/30[0m [32m==============[0m[37m======[0m [1m45s[0m 5s/step - accuracy: 0.1451 - loss: 2.0610 - top_k_categorical_accuracy: 0.8370
[1m22/30[0m [32m==============[0m[37m======[0m [1m41s[0m 5s/step - accuracy: 0.1465 - loss: 2.0591 - top_k_categorical_accuracy: 0.8371
[1m23/30[0m [32m===============[0m[37m=====[0m [1m36s[0m 5s/step - accuracy: 0.1476 - loss: 2.0575 - top_k_categorical_accuracy: 0.8372
[1m24/30[0m [32m================[0m[37m====[0m [1m31s[0m 5s/step - accuracy: 0.1486 - loss: 2.0558 - top_k_categorical_accuracy: 0.8374
[1m25/30[0m [32m================[0m[37m====[0m [1m26s[0m 5s/step - accuracy: 0.1496 - loss: 2.0545 - top_k_categorical_accuracy: 0.8376
[1m26/30[0m [32m=================[0m[37m===[0m [1m21s[0m 5s/step - accuracy: 0.1502 - loss: 2.0536 - top_k_categorical_accuracy: 0.8378
[1m27/30[0m [32m==================[0m[37m==[0m [1m16s[0m 5s/step - accuracy: 0.1509 - loss: 2.0526 - top_k_categorical_accuracy: 0.8380
[1m28/30[0m [32m==================[0m[37m==[0m [1m10s[0m 5s/step - accuracy: 0.1515 - loss: 2.0517 - top_k_categorical_accuracy: 0.8383
[1m29/30[0m [32m===================[0m[37m=[0m [1m5s[0m 5s/step - accuracy: 0.1520 - loss: 2.0510 - top_k_categorical_accuracy: 0.8386 
[1m30/30[0m [32m====================[0m[37m[0m [1m0s[0m 5s/step - accuracy: 0.1525 - loss: 2.0503 - top_k_categorical_accuracy: 0.8388
Epoch 10: val_accuracy did not improve from 0.21339

[1m30/30[0m [32m====================[0m[37m[0m [1m216s[0m 7s/step - accuracy: 0.1677 - loss: 2.0304 - top_k_categorical_accuracy: 0.8458 - val_accuracy: 0.2092 - val_loss: 1.7835 - val_top_k_categorical_accuracy: 0.8870 - learning_rate: 5.0000e-04
Epoch 11/50

[1m 1/30[0m [37m====================[0m [1m4:19[0m 9s/step - accuracy: 0.1250 - loss: 2.1158 - top_k_categorical_accuracy: 0.8750
[1m 2/30[0m [32m=[0m[37m===================[0m [1m3:00[0m 6s/step - accuracy: 0.1250 - loss: 2.0770 - top_k_categorical_accuracy: 0.8750
[1m 3/30[0m [32m==[0m[37m==================[0m [1m2:49[0m 6s/step - accuracy: 0.1389 - loss: 2.0601 - top_k_categorical_accuracy: 0.8715
[1m 4/30[0m [32m==[0m[37m==================[0m [1m2:44[0m 6s/step - accuracy: 0.1432 - loss: 2.0580 - top_k_categorical_accuracy: 0.8685
[1m 5/30[0m [32m===[0m[37m=================[0m [1m2:36[0m 6s/step - accuracy: 0.1458 - loss: 2.0511 - top_k_categorical_accuracy: 0.8673
[1m 6/30[0m [32m====[0m[37m================[0m [1m2:33[0m 6s/step - accuracy: 0.1493 - loss: 2.0440 - top_k_categorical_accuracy: 0.8660
[1m 7/30[0m [32m====[0m[37m================[0m [1m2:32[0m 7s/step - accuracy: 0.1516 - loss: 2.0402 - top_k_categorical_accuracy: 0.8641
[1m 8/30[0m [32m=====[0m[37m===============[0m [1m2:25[0m 7s/step - accuracy: 0.1531 - loss: 2.0353 - top_k_categorical_accuracy: 0.8630
[1m 9/30[0m [32m======[0m[37m==============[0m [1m2:21[0m 7s/step - accuracy: 0.1554 - loss: 2.0310 - top_k_categorical_accuracy: 0.8624
[1m10/30[0m [32m======[0m[37m==============[0m [1m2:13[0m 7s/step - accuracy: 0.1567 - loss: 2.0267 - top_k_categorical_accuracy: 0.8621
[1m11/30[0m [32m=======[0m[37m=============[0m [1m2:06[0m 7s/step - accuracy: 0.1588 - loss: 2.0228 - top_k_categorical_accuracy: 0.8617
[1m12/30[0m [32m========[0m[37m============[0m [1m2:00[0m 7s/step - accuracy: 0.1603 - loss: 2.0202 - top_k_categorical_accuracy: 0.8615
[1m13/30[0m [32m========[0m[37m============[0m [1m1:53[0m 7s/step - accuracy: 0.1615 - loss: 2.0175 - top_k_categorical_accuracy: 0.8620
[1m14/30[0m [32m=========[0m[37m===========[0m [1m1:46[0m 7s/step - accuracy: 0.1620 - loss: 2.0155 - top_k_categorical_accuracy: 0.8625
[1m15/30[0m [32m==========[0m[37m==========[0m [1m1:40[0m 7s/step - accuracy: 0.1622 - loss: 2.0144 - top_k_categorical_accuracy: 0.8625
[1m16/30[0m [32m==========[0m[37m==========[0m [1m1:33[0m 7s/step - accuracy: 0.1626 - loss: 2.0135 - top_k_categorical_accuracy: 0.8623
[1m17/30[0m [32m===========[0m[37m=========[0m [1m1:26[0m 7s/step - accuracy: 0.1630 - loss: 2.0127 - top_k_categorical_accuracy: 0.8622
[1m18/30[0m [32m============[0m[37m========[0m [1m1:19[0m 7s/step - accuracy: 0.1633 - loss: 2.0121 - top_k_categorical_accuracy: 0.8619
[1m19/30[0m [32m============[0m[37m========[0m [1m1:12[0m 7s/step - accuracy: 0.1635 - loss: 2.0118 - top_k_categorical_accuracy: 0.8617
[1m20/30[0m [32m=============[0m[37m=======[0m [1m1:05[0m 7s/step - accuracy: 0.1638 - loss: 2.0113 - top_k_categorical_accuracy: 0.8618
[1m21/30[0m [32m==============[0m[37m======[0m [1m59s[0m 7s/step - accuracy: 0.1640 - loss: 2.0111 - top_k_categorical_accuracy: 0.8619 
[1m22/30[0m [32m==============[0m[37m======[0m [1m52s[0m 7s/step - accuracy: 0.1640 - loss: 2.0112 - top_k_categorical_accuracy: 0.8620
[1m23/30[0m [32m===============[0m[37m=====[0m [1m46s[0m 7s/step - accuracy: 0.1640 - loss: 2.0115 - top_k_categorical_accuracy: 0.8620
[1m24/30[0m [32m================[0m[37m====[0m [1m39s[0m 7s/step - accuracy: 0.1639 - loss: 2.0123 - top_k_categorical_accuracy: 0.8619
[1m25/30[0m [32m================[0m[37m====[0m [1m32s[0m 7s/step - accuracy: 0.1640 - loss: 2.0131 - top_k_categorical_accuracy: 0.8617
[1m26/30[0m [32m=================[0m[37m===[0m [1m26s[0m 7s/step - accuracy: 0.1642 - loss: 2.0138 - top_k_categorical_accuracy: 0.8616
[1m27/30[0m [32m==================[0m[37m==[0m [1m19s[0m 7s/step - accuracy: 0.1643 - loss: 2.0145 - top_k_categorical_accuracy: 0.8616
[1m28/30[0m [32m==================[0m[37m==[0m [1m13s[0m 7s/step - accuracy: 0.1644 - loss: 2.0151 - top_k_categorical_accuracy: 0.8616
[1m29/30[0m [32m===================[0m[37m=[0m [1m6s[0m 7s/step - accuracy: 0.1645 - loss: 2.0156 - top_k_categorical_accuracy: 0.8616 
[1m30/30[0m [32m====================[0m[37m[0m [1m0s[0m 6s/step - accuracy: 0.1646 - loss: 2.0161 - top_k_categorical_accuracy: 0.8615
Epoch 11: val_accuracy did not improve from 0.21339

[1m30/30[0m [32m====================[0m[37m[0m [1m243s[0m 8s/step - accuracy: 0.1677 - loss: 2.0325 - top_k_categorical_accuracy: 0.8583 - val_accuracy: 0.1883 - val_loss: 1.7894 - val_top_k_categorical_accuracy: 0.8410 - learning_rate: 5.0000e-04
Epoch 12/50

[1m 1/30[0m [37m====================[0m [1m4:20[0m 9s/step - accuracy: 0.0625 - loss: 2.0322 - top_k_categorical_accuracy: 0.9062
[1m 2/30[0m [32m=[0m[37m===================[0m [1m2:44[0m 6s/step - accuracy: 0.0938 - loss: 2.0183 - top_k_categorical_accuracy: 0.8984
[1m 3/30[0m [32m==[0m[37m==================[0m [1m2:42[0m 6s/step - accuracy: 0.1042 - loss: 2.0238 - top_k_categorical_accuracy: 0.8976
[1m 4/30[0m [32m==[0m[37m==================[0m [1m2:38[0m 6s/step - accuracy: 0.1172 - loss: 2.0223 - top_k_categorical_accuracy: 0.8939
[1m 5/30[0m [32m===[0m[37m=================[0m [1m2:34[0m 6s/step - accuracy: 0.1275 - loss: 2.0236 - top_k_categorical_accuracy: 0.8864
[1m 6/30[0m [32m====[0m[37m================[0m [1m2:33[0m 6s/step - accuracy: 0.1392 - loss: 2.0154 - top_k_categorical_accuracy: 0.8827
[1m 7/30[0m [32m====[0m[37m================[0m [1m2:28[0m 6s/step - accuracy: 0.1487 - loss: 2.0112 - top_k_categorical_accuracy: 0.8784
[1m 8/30[0m [32m=====[0m[37m===============[0m [1m2:21[0m 6s/step - accuracy: 0.1560 - loss: 2.0095 - top_k_categorical_accuracy: 0.8751
[1m 9/30[0m [32m======[0m[37m==============[0m [1m2:13[0m 6s/step - accuracy: 0.1610 - loss: 2.0098 - top_k_categorical_accuracy: 0.8712
[1m10/30[0m [32m======[0m[37m==============[0m [1m2:07[0m 6s/step - accuracy: 0.1649 - loss: 2.0105 - top_k_categorical_accuracy: 0.8685
[1m11/30[0m [32m=======[0m[37m=============[0m [1m2:01[0m 6s/step - accuracy: 0.1675 - loss: 2.0119 - top_k_categorical_accuracy: 0.8662
[1m12/30[0m [32m========[0m[37m============[0m [1m1:54[0m 6s/step - accuracy: 0.1698 - loss: 2.0132 - top_k_categorical_accuracy: 0.8641
[1m13/30[0m [32m========[0m[37m============[0m [1m1:47[0m 6s/step - accuracy: 0.1715 - loss: 2.0143 - top_k_categorical_accuracy: 0.8624
[1m14/30[0m [32m=========[0m[37m===========[0m [1m1:40[0m 6s/step - accuracy: 0.1732 - loss: 2.0166 - top_k_categorical_accuracy: 0.8604
[1m15/30[0m [32m==========[0m[37m==========[0m [1m1:34[0m 6s/step - accuracy: 0.1745 - loss: 2.0187 - top_k_categorical_accuracy: 0.8585
[1m16/30[0m [32m==========[0m[37m==========[0m [1m1:29[0m 6s/step - accuracy: 0.1756 - loss: 2.0205 - top_k_categorical_accuracy: 0.8569
[1m17/30[0m [32m===========[0m[37m=========[0m [1m1:22[0m 6s/step - accuracy: 0.1762 - loss: 2.0222 - top_k_categorical_accuracy: 0.8556
[1m18/30[0m [32m============[0m[37m========[0m [1m1:16[0m 6s/step - accuracy: 0.1764 - loss: 2.0247 - top_k_categorical_accuracy: 0.8543
[1m19/30[0m [32m============[0m[37m========[0m [1m1:09[0m 6s/step - accuracy: 0.1767 - loss: 2.0273 - top_k_categorical_accuracy: 0.8529
[1m20/30[0m [32m=============[0m[37m=======[0m [1m1:03[0m 6s/step - accuracy: 0.1771 - loss: 2.0297 - top_k_categorical_accuracy: 0.8515
[1m21/30[0m [32m==============[0m[37m======[0m [1m56s[0m 6s/step - accuracy: 0.1773 - loss: 2.0320 - top_k_categorical_accuracy: 0.8500 
[1m22/30[0m [32m==============[0m[37m======[0m [1m50s[0m 6s/step - accuracy: 0.1775 - loss: 2.0336 - top_k_categorical_accuracy: 0.8489
[1m23/30[0m [32m===============[0m[37m=====[0m [1m44s[0m 6s/step - accuracy: 0.1776 - loss: 2.0353 - top_k_categorical_accuracy: 0.8478
[1m24/30[0m [32m================[0m[37m====[0m [1m37s[0m 6s/step - accuracy: 0.1777 - loss: 2.0366 - top_k_categorical_accuracy: 0.8471
[1m25/30[0m [32m================[0m[37m====[0m [1m31s[0m 6s/step - accuracy: 0.1778 - loss: 2.0372 - top_k_categorical_accuracy: 0.8466
[1m26/30[0m [32m=================[0m[37m===[0m [1m25s[0m 6s/step - accuracy: 0.1777 - loss: 2.0381 - top_k_categorical_accuracy: 0.8461
[1m27/30[0m [32m==================[0m[37m==[0m [1m19s[0m 6s/step - accuracy: 0.1777 - loss: 2.0387 - top_k_categorical_accuracy: 0.8458
[1m28/30[0m [32m==================[0m[37m==[0m [1m12s[0m 6s/step - accuracy: 0.1778 - loss: 2.0390 - top_k_categorical_accuracy: 0.8456
[1m29/30[0m [32m===================[0m[37m=[0m [1m6s[0m 6s/step - accuracy: 0.1780 - loss: 2.0392 - top_k_categorical_accuracy: 0.8455 
[1m30/30[0m [32m====================[0m[37m[0m [1m0s[0m 6s/step - accuracy: 0.1781 - loss: 2.0394 - top_k_categorical_accuracy: 0.8453
Epoch 12: val_accuracy did not improve from 0.21339

[1m30/30[0m [32m====================[0m[37m[0m [1m246s[0m 8s/step - accuracy: 0.1813 - loss: 2.0464 - top_k_categorical_accuracy: 0.8406 - val_accuracy: 0.1799 - val_loss: 1.7903 - val_top_k_categorical_accuracy: 0.8745 - learning_rate: 5.0000e-04
Epoch 13/50

[1m 1/30[0m [37m====================[0m [1m4:19[0m 9s/step - accuracy: 0.1250 - loss: 2.0979 - top_k_categorical_accuracy: 0.8125
[1m 2/30[0m [32m=[0m[37m===================[0m [1m2:51[0m 6s/step - accuracy: 0.1172 - loss: 2.1027 - top_k_categorical_accuracy: 0.8125
[1m 3/30[0m [32m==[0m[37m==================[0m [1m2:47[0m 6s/step - accuracy: 0.1302 - loss: 2.0937 - top_k_categorical_accuracy: 0.8090
[1m 4/30[0m [32m==[0m[37m==================[0m [1m2:38[0m 6s/step - accuracy: 0.1445 - loss: 2.0754 - top_k_categorical_accuracy: 0.8079
[1m 5/30[0m [32m===[0m[37m=================[0m [1m2:35[0m 6s/step - accuracy: 0.1506 - loss: 2.0619 - top_k_categorical_accuracy: 0.8076
[1m 6/30[0m [32m====[0m[37m================[0m [1m2:36[0m 7s/step - accuracy: 0.1559 - loss: 2.0555 - top_k_categorical_accuracy: 0.8058
[1m 7/30[0m [32m====[0m[37m================[0m [1m2:24[0m 6s/step - accuracy: 0.1611 - loss: 2.0472 - top_k_categorical_accuracy: 0.8068
[1m 8/30[0m [32m=====[0m[37m===============[0m [1m2:10[0m 6s/step - accuracy: 0.1644 - loss: 2.0424 - top_k_categorical_accuracy: 0.8075
[1m 9/30[0m [32m======[0m[37m==============[0m [1m2:00[0m 6s/step - accuracy: 0.1665 - loss: 2.0395 - top_k_categorical_accuracy: 0.8077
[1m10/30[0m [32m======[0m[37m==============[0m [1m1:50[0m 6s/step - accuracy: 0.1680 - loss: 2.0381 - top_k_categorical_accuracy: 0.8078
[1m11/30[0m [32m=======[0m[37m=============[0m [1m1:42[0m 5s/step - accuracy: 0.1698 - loss: 2.0368 - top_k_categorical_accuracy: 0.8088
[1m12/30[0m [32m========[0m[37m============[0m [1m1:35[0m 5s/step - accuracy: 0.1726 - loss: 2.0350 - top_k_categorical_accuracy: 0.8093
[1m13/30[0m [32m========[0m[37m============[0m [1m1:29[0m 5s/step - accuracy: 0.1748 - loss: 2.0338 - top_k_categorical_accuracy: 0.8101
[1m14/30[0m [32m=========[0m[37m===========[0m [1m1:23[0m 5s/step - accuracy: 0.1764 - loss: 2.0317 - top_k_categorical_accuracy: 0.8114
[1m15/30[0m [32m==========[0m[37m==========[0m [1m1:17[0m 5s/step - accuracy: 0.1779 - loss: 2.0298 - top_k_categorical_accuracy: 0.8124
[1m16/30[0m [32m==========[0m[37m==========[0m [1m1:11[0m 5s/step - accuracy: 0.1793 - loss: 2.0275 - top_k_categorical_accuracy: 0.8135
[1m17/30[0m [32m===========[0m[37m=========[0m [1m1:05[0m 5s/step - accuracy: 0.1803 - loss: 2.0253 - top_k_categorical_accuracy: 0.8147
[1m18/30[0m [32m============[0m[37m========[0m [1m1:00[0m 5s/step - accuracy: 0.1810 - loss: 2.0231 - top_k_categorical_accuracy: 0.8158
[1m19/30[0m [32m============[0m[37m========[0m [1m55s[0m 5s/step - accuracy: 0.1816 - loss: 2.0207 - top_k_categorical_accuracy: 0.8168 
[1m20/30[0m [32m=============[0m[37m=======[0m [1m50s[0m 5s/step - accuracy: 0.1820 - loss: 2.0189 - top_k_categorical_accuracy: 0.8177
[1m21/30[0m [32m==============[0m[37m======[0m [1m44s[0m 5s/step - accuracy: 0.1823 - loss: 2.0171 - top_k_categorical_accuracy: 0.8186
[1m22/30[0m [32m==============[0m[37m======[0m [1m39s[0m 5s/step - accuracy: 0.1825 - loss: 2.0156 - top_k_categorical_accuracy: 0.8195
[1m23/30[0m [32m===============[0m[37m=====[0m [1m34s[0m 5s/step - accuracy: 0.1827 - loss: 2.0141 - top_k_categorical_accuracy: 0.8205
[1m24/30[0m [32m================[0m[37m====[0m [1m29s[0m 5s/step - accuracy: 0.1828 - loss: 2.0128 - top_k_categorical_accuracy: 0.8214
[1m25/30[0m [32m================[0m[37m====[0m [1m24s[0m 5s/step - accuracy: 0.1830 - loss: 2.0114 - top_k_categorical_accuracy: 0.8222
[1m26/30[0m [32m=================[0m[37m===[0m [1m19s[0m 5s/step - accuracy: 0.1830 - loss: 2.0103 - top_k_categorical_accuracy: 0.8230
[1m27/30[0m [32m==================[0m[37m==[0m [1m14s[0m 5s/step - accuracy: 0.1832 - loss: 2.0091 - top_k_categorical_accuracy: 0.8238
[1m28/30[0m [32m==================[0m[37m==[0m [1m9s[0m 5s/step - accuracy: 0.1832 - loss: 2.0080 - top_k_categorical_accuracy: 0.8246 
[1m29/30[0m [32m===================[0m[37m=[0m [1m4s[0m 5s/step - accuracy: 0.1832 - loss: 2.0074 - top_k_categorical_accuracy: 0.8254
[1m30/30[0m [32m====================[0m[37m[0m [1m0s[0m 5s/step - accuracy: 0.1830 - loss: 2.0070 - top_k_categorical_accuracy: 0.8260
Epoch 13: val_accuracy did not improve from 0.21339

[1m30/30[0m [32m====================[0m[37m[0m [1m187s[0m 6s/step - accuracy: 0.1781 - loss: 1.9955 - top_k_categorical_accuracy: 0.8448 - val_accuracy: 0.1967 - val_loss: 1.7916 - val_top_k_categorical_accuracy: 0.8410 - learning_rate: 5.0000e-04
Epoch 14/50

[1m 1/30[0m [37m====================[0m [1m3:13[0m 7s/step - accuracy: 0.1250 - loss: 2.0015 - top_k_categorical_accuracy: 0.9062
[1m 2/30[0m [32m=[0m[37m===================[0m [1m1:58[0m 4s/step - accuracy: 0.1797 - loss: 1.9412 - top_k_categorical_accuracy: 0.8828
[1m 3/30[0m [32m==[0m[37m==================[0m [1m1:53[0m 4s/step - accuracy: 0.1997 - loss: 1.9026 - top_k_categorical_accuracy: 0.8733
[1m 4/30[0m [32m==[0m[37m==================[0m [1m1:49[0m 4s/step - accuracy: 0.2083 - loss: 1.8958 - top_k_categorical_accuracy: 0.8639
[1m 5/30[0m [32m===[0m[37m=================[0m [1m1:49[0m 4s/step - accuracy: 0.2142 - loss: 1.8990 - top_k_categorical_accuracy: 0.8586
[1m 6/30[0m [32m====[0m[37m================[0m [1m1:44[0m 4s/step - accuracy: 0.2167 - loss: 1.9011 - top_k_categorical_accuracy: 0.8562
[1m 7/30[0m [32m====[0m[37m================[0m [1m1:35[0m 4s/step - accuracy: 0.2189 - loss: 1.9003 - top_k_categorical_accuracy: 0.8550
[1m 8/30[0m [32m=====[0m[37m===============[0m [1m1:27[0m 4s/step - accuracy: 0.2193 - loss: 1.9006 - top_k_categorical_accuracy: 0.8536
[1m 9/30[0m [32m======[0m[37m==============[0m [1m1:19[0m 4s/step - accuracy: 0.2193 - loss: 1.9036 - top_k_categorical_accuracy: 0.8506
[1m10/30[0m [32m======[0m[37m==============[0m [1m1:12[0m 4s/step - accuracy: 0.2183 - loss: 1.9088 - top_k_categorical_accuracy: 0.8474
[1m11/30[0m [32m=======[0m[37m=============[0m [1m1:06[0m 4s/step - accuracy: 0.2176 - loss: 1.9119 - top_k_categorical_accuracy: 0.8460
[1m12/30[0m [32m========[0m[37m============[0m [1m1:03[0m 4s/step - accuracy: 0.2166 - loss: 1.9141 - top_k_categorical_accuracy: 0.8443
[1m13/30[0m [32m========[0m[37m============[0m [1m1:01[0m 4s/step - accuracy: 0.2162 - loss: 1.9150 - top_k_categorical_accuracy: 0.8435
[1m14/30[0m [32m=========[0m[37m===========[0m [1m58s[0m 4s/step - accuracy: 0.2151 - loss: 1.9159 - top_k_categorical_accuracy: 0.8432 
[1m15/30[0m [32m==========[0m[37m==========[0m [1m55s[0m 4s/step - accuracy: 0.2141 - loss: 1.9173 - top_k_categorical_accuracy: 0.8431
[1m16/30[0m [32m==========[0m[37m==========[0m [1m51s[0m 4s/step - accuracy: 0.2130 - loss: 1.9184 - top_k_categorical_accuracy: 0.8431
[1m17/30[0m [32m===========[0m[37m=========[0m [1m48s[0m 4s/step - accuracy: 0.2118 - loss: 1.9199 - top_k_categorical_accuracy: 0.8430
[1m18/30[0m [32m============[0m[37m========[0m [1m45s[0m 4s/step - accuracy: 0.2102 - loss: 1.9215 - top_k_categorical_accuracy: 0.8428
[1m19/30[0m [32m============[0m[37m========[0m [1m41s[0m 4s/step - accuracy: 0.2087 - loss: 1.9232 - top_k_categorical_accuracy: 0.8425
[1m20/30[0m [32m=============[0m[37m=======[0m [1m37s[0m 4s/step - accuracy: 0.2074 - loss: 1.9246 - top_k_categorical_accuracy: 0.8421
[1m21/30[0m [32m==============[0m[37m======[0m [1m33s[0m 4s/step - accuracy: 0.2061 - loss: 1.9256 - top_k_categorical_accuracy: 0.8421
[1m22/30[0m [32m==============[0m[37m======[0m [1m29s[0m 4s/step - accuracy: 0.2052 - loss: 1.9265 - top_k_categorical_accuracy: 0.8418
[1m23/30[0m [32m===============[0m[37m=====[0m [1m25s[0m 4s/step - accuracy: 0.2045 - loss: 1.9274 - top_k_categorical_accuracy: 0.8414
[1m24/30[0m [32m================[0m[37m====[0m [1m21s[0m 4s/step - accuracy: 0.2038 - loss: 1.9281 - top_k_categorical_accuracy: 0.8414
[1m25/30[0m [32m================[0m[37m====[0m [1m17s[0m 4s/step - accuracy: 0.2031 - loss: 1.9289 - top_k_categorical_accuracy: 0.8414
[1m26/30[0m [32m=================[0m[37m===[0m [1m14s[0m 4s/step - accuracy: 0.2024 - loss: 1.9299 - top_k_categorical_accuracy: 0.8414
[1m27/30[0m [32m==================[0m[37m==[0m [1m10s[0m 3s/step - accuracy: 0.2018 - loss: 1.9308 - top_k_categorical_accuracy: 0.8414
[1m28/30[0m [32m==================[0m[37m==[0m [1m6s[0m 3s/step - accuracy: 0.2012 - loss: 1.9319 - top_k_categorical_accuracy: 0.8413 
[1m29/30[0m [32m===================[0m[37m=[0m [1m3s[0m 3s/step - accuracy: 0.2007 - loss: 1.9329 - top_k_categorical_accuracy: 0.8412
[1m30/30[0m [32m====================[0m[37m[0m [1m0s[0m 3s/step - accuracy: 0.2003 - loss: 1.9337 - top_k_categorical_accuracy: 0.8411
Epoch 14: val_accuracy did not improve from 0.21339

Epoch 14: ReduceLROnPlateau reducing learning rate to 0.0002500000118743628.

[1m30/30[0m [32m====================[0m[37m[0m [1m144s[0m 5s/step - accuracy: 0.1896 - loss: 1.9574 - top_k_categorical_accuracy: 0.8375 - val_accuracy: 0.1799 - val_loss: 1.7836 - val_top_k_categorical_accuracy: 0.8494 - learning_rate: 5.0000e-04
Epoch 15/50

[1m 1/30[0m [37m====================[0m [1m34:10[0m 71s/step - accuracy: 0.1875 - loss: 1.9404 - top_k_categorical_accuracy: 0.8438
[1m 2/30[0m [32m=[0m[37m===================[0m [1m2:46[0m 6s/step - accuracy: 0.1875 - loss: 1.9708 - top_k_categorical_accuracy: 0.8438  
[1m 3/30[0m [32m==[0m[37m==================[0m [1m2:44[0m 6s/step - accuracy: 0.1910 - loss: 1.9857 - top_k_categorical_accuracy: 0.8403
[1m 4/30[0m [32m==[0m[37m==================[0m [1m2:37[0m 6s/step - accuracy: 0.1940 - loss: 1.9891 - top_k_categorical_accuracy: 0.8411
[1m 5/30[0m [32m===[0m[37m=================[0m [1m2:33[0m 6s/step - accuracy: 0.1952 - loss: 1.9863 - top_k_categorical_accuracy: 0.8442
[1m 6/30[0m [32m====[0m[37m================[0m [1m2:27[0m 6s/step - accuracy: 0.1948 - loss: 1.9861 - top_k_categorical_accuracy: 0.8467
[1m 7/30[0m [32m====[0m[37m================[0m [1m2:22[0m 6s/step - accuracy: 0.1957 - loss: 1.9835 - top_k_categorical_accuracy: 0.8495
[1m 8/30[0m [32m=====[0m[37m===============[0m [1m2:15[0m 6s/step - accuracy: 0.1946 - loss: 1.9815 - top_k_categorical_accuracy: 0.8507
[1m 9/30[0m [32m======[0m[37m==============[0m [1m2:10[0m 6s/step - accuracy: 0.1946 - loss: 1.9792 - top_k_categorical_accuracy: 0.8519
[1m10/30[0m [32m======[0m[37m==============[0m [1m2:07[0m 6s/step - accuracy: 0.1961 - loss: 1.9756 - top_k_categorical_accuracy: 0.8529
[1m11/30[0m [32m=======[0m[37m=============[0m [1m2:00[0m 6s/step - accuracy: 0.1971 - loss: 1.9736 - top_k_categorical_accuracy: 0.8534
[1m12/30[0m [32m========[0m[37m============[0m [1m1:53[0m 6s/step - accuracy: 0.1978 - loss: 1.9725 - top_k_categorical_accuracy: 0.8539
[1m13/30[0m [32m========[0m[37m============[0m [1m1:46[0m 6s/step - accuracy: 0.1978 - loss: 1.9725 - top_k_categorical_accuracy: 0.8538
[1m14/30[0m [32m=========[0m[37m===========[0m [1m1:40[0m 6s/step - accuracy: 0.1977 - loss: 1.9731 - top_k_categorical_accuracy: 0.8538
[1m15/30[0m [32m==========[0m[37m==========[0m [1m1:34[0m 6s/step - accuracy: 0.1977 - loss: 1.9735 - top_k_categorical_accuracy: 0.8532
[1m16/30[0m [32m==========[0m[37m==========[0m [1m1:27[0m 6s/step - accuracy: 0.1974 - loss: 1.9733 - top_k_categorical_accuracy: 0.8529
[1m17/30[0m [32m===========[0m[37m=========[0m [1m1:19[0m 6s/step - accuracy: 0.1975 - loss: 1.9724 - top_k_categorical_accuracy: 0.8528
[1m18/30[0m [32m============[0m[37m========[0m [1m1:12[0m 6s/step - accuracy: 0.1972 - loss: 1.9720 - top_k_categorical_accuracy: 0.8528
[1m19/30[0m [32m============[0m[37m========[0m [1m1:05[0m 6s/step - accuracy: 0.1970 - loss: 1.9714 - top_k_categorical_accuracy: 0.8525
[1m20/30[0m [32m=============[0m[37m=======[0m [1m58s[0m 6s/step - accuracy: 0.1967 - loss: 1.9711 - top_k_categorical_accuracy: 0.8523 
[1m21/30[0m [32m==============[0m[37m======[0m [1m52s[0m 6s/step - accuracy: 0.1963 - loss: 1.9708 - top_k_categorical_accuracy: 0.8520
[1m22/30[0m [32m==============[0m[37m======[0m [1m45s[0m 6s/step - accuracy: 0.1959 - loss: 1.9704 - top_k_categorical_accuracy: 0.8518
[1m23/30[0m [32m===============[0m[37m=====[0m [1m39s[0m 6s/step - accuracy: 0.1956 - loss: 1.9701 - top_k_categorical_accuracy: 0.8514
[1m24/30[0m [32m================[0m[37m====[0m [1m33s[0m 6s/step - accuracy: 0.1953 - loss: 1.9699 - top_k_categorical_accuracy: 0.8509
[1m25/30[0m [32m================[0m[37m====[0m [1m27s[0m 6s/step - accuracy: 0.1949 - loss: 1.9699 - top_k_categorical_accuracy: 0.8503
[1m26/30[0m [32m=================[0m[37m===[0m [1m22s[0m 6s/step - accuracy: 0.1946 - loss: 1.9699 - top_k_categorical_accuracy: 0.8500
[1m27/30[0m [32m==================[0m[37m==[0m [1m16s[0m 5s/step - accuracy: 0.1943 - loss: 1.9702 - top_k_categorical_accuracy: 0.8497
[1m28/30[0m [32m==================[0m[37m==[0m [1m10s[0m 5s/step - accuracy: 0.1940 - loss: 1.9706 - top_k_categorical_accuracy: 0.8493
[1m29/30[0m [32m===================[0m[37m=[0m [1m5s[0m 5s/step - accuracy: 0.1938 - loss: 1.9711 - top_k_categorical_accuracy: 0.8490 
[1m30/30[0m [32m====================[0m[37m[0m [1m0s[0m 5s/step - accuracy: 0.1935 - loss: 1.9716 - top_k_categorical_accuracy: 0.8487
Epoch 15: val_accuracy did not improve from 0.21339

[1m30/30[0m [32m====================[0m[37m[0m [1m271s[0m 7s/step - accuracy: 0.1865 - loss: 1.9866 - top_k_categorical_accuracy: 0.8396 - val_accuracy: 0.1548 - val_loss: 1.7872 - val_top_k_categorical_accuracy: 0.8494 - learning_rate: 2.5000e-04
Epoch 16/50

[1m 1/30[0m [37m====================[0m [1m29:04[0m 60s/step - accuracy: 0.1250 - loss: 2.0144 - top_k_categorical_accuracy: 0.8750
[1m 2/30[0m [32m=[0m[37m===================[0m [1m3:01[0m 6s/step - accuracy: 0.1719 - loss: 1.9990 - top_k_categorical_accuracy: 0.8906  
[1m 3/30[0m [32m==[0m[37m==================[0m [1m2:49[0m 6s/step - accuracy: 0.1840 - loss: 1.9867 - top_k_categorical_accuracy: 0.8958
[1m 4/30[0m [32m==[0m[37m==================[0m [1m2:42[0m 6s/step - accuracy: 0.1829 - loss: 1.9802 - top_k_categorical_accuracy: 0.8984
[1m 5/30[0m [32m===[0m[37m=================[0m [1m2:37[0m 6s/step - accuracy: 0.1851 - loss: 1.9751 - top_k_categorical_accuracy: 0.8975
[1m 6/30[0m [32m====[0m[37m================[0m [1m2:38[0m 7s/step - accuracy: 0.1855 - loss: 1.9838 - top_k_categorical_accuracy: 0.8929
[1m 7/30[0m [32m====[0m[37m================[0m [1m2:37[0m 7s/step - accuracy: 0.1858 - loss: 1.9893 - top_k_categorical_accuracy: 0.8897
[1m 8/30[0m [32m=====[0m[37m===============[0m [1m2:28[0m 7s/step - accuracy: 0.1850 - loss: 1.9946 - top_k_categorical_accuracy: 0.8869
[1m 9/30[0m [32m======[0m[37m==============[0m [1m2:21[0m 7s/step - accuracy: 0.1830 - loss: 1.9982 - top_k_categorical_accuracy: 0.8848
[1m10/30[0m [32m======[0m[37m==============[0m [1m2:13[0m 7s/step - accuracy: 0.1822 - loss: 1.9980 - top_k_categorical_accuracy: 0.8838
[1m11/30[0m [32m=======[0m[37m=============[0m [1m2:06[0m 7s/step - accuracy: 0.1811 - loss: 1.9979 - top_k_categorical_accuracy: 0.8827
[1m12/30[0m [32m========[0m[37m============[0m [1m2:00[0m 7s/step - accuracy: 0.1799 - loss: 1.9991 - top_k_categorical_accuracy: 0.8815
[1m13/30[0m [32m========[0m[37m============[0m [1m1:53[0m 7s/step - accuracy: 0.1788 - loss: 2.0005 - top_k_categorical_accuracy: 0.8798
[1m14/30[0m [32m=========[0m[37m===========[0m [1m1:46[0m 7s/step - accuracy: 0.1783 - loss: 2.0011 - top_k_categorical_accuracy: 0.8789
[1m15/30[0m [32m==========[0m[37m==========[0m [1m1:41[0m 7s/step - accuracy: 0.1778 - loss: 2.0014 - top_k_categorical_accuracy: 0.8780
[1m16/30[0m [32m==========[0m[37m==========[0m [1m1:35[0m 7s/step - accuracy: 0.1776 - loss: 2.0021 - top_k_categorical_accuracy: 0.8769
[1m17/30[0m [32m===========[0m[37m=========[0m [1m1:27[0m 7s/step - accuracy: 0.1773 - loss: 2.0022 - top_k_categorical_accuracy: 0.8757
[1m18/30[0m [32m============[0m[37m========[0m [1m1:20[0m 7s/step - accuracy: 0.1774 - loss: 2.0020 - top_k_categorical_accuracy: 0.8746
[1m19/30[0m [32m============[0m[37m========[0m [1m1:13[0m 7s/step - accuracy: 0.1777 - loss: 2.0018 - top_k_categorical_accuracy: 0.8735
[1m20/30[0m [32m=============[0m[37m=======[0m [1m1:06[0m 7s/step - accuracy: 0.1779 - loss: 2.0016 - top_k_categorical_accuracy: 0.8723
[1m21/30[0m [32m==============[0m[37m======[0m [1m1:00[0m 7s/step - accuracy: 0.1781 - loss: 2.0015 - top_k_categorical_accuracy: 0.8712
[1m22/30[0m [32m==============[0m[37m======[0m [1m54s[0m 7s/step - accuracy: 0.1785 - loss: 2.0011 - top_k_categorical_accuracy: 0.8702 
[1m23/30[0m [32m===============[0m[37m=====[0m [1m47s[0m 7s/step - accuracy: 0.1789 - loss: 2.0005 - top_k_categorical_accuracy: 0.8693
[1m24/30[0m [32m================[0m[37m====[0m [1m41s[0m 7s/step - accuracy: 0.1792 - loss: 1.9999 - top_k_categorical_accuracy: 0.8685
[1m25/30[0m [32m================[0m[37m====[0m [1m33s[0m 7s/step - accuracy: 0.1794 - loss: 1.9994 - top_k_categorical_accuracy: 0.8678
[1m26/30[0m [32m=================[0m[37m===[0m [1m26s[0m 7s/step - accuracy: 0.1797 - loss: 1.9988 - top_k_categorical_accuracy: 0.8673
[1m27/30[0m [32m==================[0m[37m==[0m [1m19s[0m 7s/step - accuracy: 0.1800 - loss: 1.9979 - top_k_categorical_accuracy: 0.8671
[1m28/30[0m [32m==================[0m[37m==[0m [1m13s[0m 7s/step - accuracy: 0.1803 - loss: 1.9969 - top_k_categorical_accuracy: 0.8669
[1m29/30[0m [32m===================[0m[37m=[0m [1m6s[0m 7s/step - accuracy: 0.1805 - loss: 1.9958 - top_k_categorical_accuracy: 0.8668 
[1m30/30[0m [32m====================[0m[37m[0m [1m0s[0m 6s/step - accuracy: 0.1807 - loss: 1.9946 - top_k_categorical_accuracy: 0.8667
Epoch 16: val_accuracy did not improve from 0.21339

[1m30/30[0m [32m====================[0m[37m[0m [1m296s[0m 8s/step - accuracy: 0.1885 - loss: 1.9625 - top_k_categorical_accuracy: 0.8656 - val_accuracy: 0.1757 - val_loss: 1.7802 - val_top_k_categorical_accuracy: 0.8619 - learning_rate: 2.5000e-04
Epoch 17/50

[1m 1/30[0m [37m====================[0m [1m12:59[0m 27s/step - accuracy: 0.1875 - loss: 2.0283 - top_k_categorical_accuracy: 0.7188
[1m 2/30[0m [32m=[0m[37m===================[0m [1m3:17[0m 7s/step - accuracy: 0.1875 - loss: 2.0200 - top_k_categorical_accuracy: 0.7109  
[1m 3/30[0m [32m==[0m[37m==================[0m [1m3:03[0m 7s/step - accuracy: 0.1840 - loss: 1.9940 - top_k_categorical_accuracy: 0.7240
[1m 4/30[0m [32m==[0m[37m==================[0m [1m2:50[0m 7s/step - accuracy: 0.1810 - loss: 1.9943 - top_k_categorical_accuracy: 0.7305
[1m 5/30[0m [32m===[0m[37m=================[0m [1m2:43[0m 7s/step - accuracy: 0.1823 - loss: 1.9926 - top_k_categorical_accuracy: 0.7406
[1m 6/30[0m [32m====[0m[37m================[0m [1m2:35[0m 6s/step - accuracy: 0.1823 - loss: 1.9902 - top_k_categorical_accuracy: 0.7500
[1m 7/30[0m [32m====[0m[37m================[0m [1m2:29[0m 6s/step - accuracy: 0.1818 - loss: 1.9865 - top_k_categorical_accuracy: 0.7577
[1m 8/30[0m [32m=====[0m[37m===============[0m [1m2:22[0m 6s/step - accuracy: 0.1825 - loss: 1.9815 - top_k_categorical_accuracy: 0.7640
[1m 9/30[0m [32m======[0m[37m==============[0m [1m2:15[0m 6s/step - accuracy: 0.1830 - loss: 1.9795 - top_k_categorical_accuracy: 0.7686
[1m10/30[0m [32m======[0m[37m==============[0m [1m2:08[0m 6s/step - accuracy: 0.1822 - loss: 1.9792 - top_k_categorical_accuracy: 0.7715
[1m11/30[0m [32m=======[0m[37m=============[0m [1m2:02[0m 6s/step - accuracy: 0.1814 - loss: 1.9787 - top_k_categorical_accuracy: 0.7747
[1m12/30[0m [32m========[0m[37m============[0m [1m1:56[0m 6s/step - accuracy: 0.1813 - loss: 1.9773 - top_k_categorical_accuracy: 0.7780
[1m13/30[0m [32m========[0m[37m============[0m [1m1:52[0m 7s/step - accuracy: 0.1812 - loss: 1.9763 - top_k_categorical_accuracy: 0.7809
[1m14/30[0m [32m=========[0m[37m===========[0m [1m1:44[0m 7s/step - accuracy: 0.1809 - loss: 1.9755 - top_k_categorical_accuracy: 0.7839
[1m15/30[0m [32m==========[0m[37m==========[0m [1m1:36[0m 6s/step - accuracy: 0.1806 - loss: 1.9758 - top_k_categorical_accuracy: 0.7863
[1m16/30[0m [32m==========[0m[37m==========[0m [1m1:30[0m 6s/step - accuracy: 0.1802 - loss: 1.9762 - top_k_categorical_accuracy: 0.7885
[1m17/30[0m [32m===========[0m[37m=========[0m [1m1:24[0m 6s/step - accuracy: 0.1799 - loss: 1.9765 - top_k_categorical_accuracy: 0.7905
[1m18/30[0m [32m============[0m[37m========[0m [1m1:17[0m 6s/step - accuracy: 0.1795 - loss: 1.9767 - top_k_categorical_accuracy: 0.7924
[1m19/30[0m [32m============[0m[37m========[0m [1m1:10[0m 6s/step - accuracy: 0.1794 - loss: 1.9763 - top_k_categorical_accuracy: 0.7945
[1m20/30[0m [32m=============[0m[37m=======[0m [1m1:04[0m 6s/step - accuracy: 0.1793 - loss: 1.9757 - top_k_categorical_accuracy: 0.7963
[1m21/30[0m [32m==============[0m[37m======[0m [1m58s[0m 6s/step - accuracy: 0.1793 - loss: 1.9751 - top_k_categorical_accuracy: 0.7981 
[1m22/30[0m [32m==============[0m[37m======[0m [1m52s[0m 7s/step - accuracy: 0.1794 - loss: 1.9740 - top_k_categorical_accuracy: 0.7999
[1m23/30[0m [32m===============[0m[37m=====[0m [1m45s[0m 7s/step - accuracy: 0.1794 - loss: 1.9730 - top_k_categorical_accuracy: 0.8018
[1m24/30[0m [32m================[0m[37m====[0m [1m39s[0m 7s/step - accuracy: 0.1794 - loss: 1.9723 - top_k_categorical_accuracy: 0.8035
[1m25/30[0m [32m================[0m[37m====[0m [1m32s[0m 6s/step - accuracy: 0.1793 - loss: 1.9719 - top_k_categorical_accuracy: 0.8051
[1m26/30[0m [32m=================[0m[37m===[0m [1m25s[0m 6s/step - accuracy: 0.1792 - loss: 1.9715 - top_k_categorical_accuracy: 0.8066
[1m27/30[0m [32m==================[0m[37m==[0m [1m19s[0m 6s/step - accuracy: 0.1791 - loss: 1.9713 - top_k_categorical_accuracy: 0.8079
[1m28/30[0m [32m==================[0m[37m==[0m [1m12s[0m 6s/step - accuracy: 0.1790 - loss: 1.9711 - top_k_categorical_accuracy: 0.8092
[1m29/30[0m [32m===================[0m[37m=[0m [1m6s[0m 6s/step - accuracy: 0.1790 - loss: 1.9708 - top_k_categorical_accuracy: 0.8105 
[1m30/30[0m [32m====================[0m[37m[0m [1m0s[0m 6s/step - accuracy: 0.1789 - loss: 1.9706 - top_k_categorical_accuracy: 0.8116
Epoch 17: val_accuracy did not improve from 0.21339

[1m30/30[0m [32m====================[0m[37m[0m [1m259s[0m 8s/step - accuracy: 0.1771 - loss: 1.9636 - top_k_categorical_accuracy: 0.8427 - val_accuracy: 0.1925 - val_loss: 1.7789 - val_top_k_categorical_accuracy: 0.8828 - learning_rate: 2.5000e-04
Epoch 18/50

[1m 1/30[0m [37m====================[0m [1m4:22[0m 9s/step - accuracy: 0.2188 - loss: 1.9024 - top_k_categorical_accuracy: 0.8438
[1m 2/30[0m [32m=[0m[37m===================[0m [1m3:12[0m 7s/step - accuracy: 0.2109 - loss: 1.8837 - top_k_categorical_accuracy: 0.8516
[1m 3/30[0m [32m==[0m[37m==================[0m [1m3:15[0m 7s/step - accuracy: 0.1927 - loss: 1.8766 - top_k_categorical_accuracy: 0.8594
[1m 4/30[0m [32m==[0m[37m==================[0m [1m2:57[0m 7s/step - accuracy: 0.1914 - loss: 1.8744 - top_k_categorical_accuracy: 0.8594
[1m 5/30[0m [32m===[0m[37m=================[0m [1m2:45[0m 7s/step - accuracy: 0.1894 - loss: 1.8824 - top_k_categorical_accuracy: 0.8575
[1m 6/30[0m [32m====[0m[37m================[0m [1m2:35[0m 6s/step - accuracy: 0.1917 - loss: 1.8857 - top_k_categorical_accuracy: 0.8543
[1m 7/30[0m [32m====[0m[37m================[0m [1m2:27[0m 6s/step - accuracy: 0.1911 - loss: 1.8933 - top_k_categorical_accuracy: 0.8503
[1m 8/30[0m [32m=====[0m[37m===============[0m [1m2:15[0m 6s/step - accuracy: 0.1901 - loss: 1.9002 - top_k_categorical_accuracy: 0.8480
[1m 9/30[0m [32m======[0m[37m==============[0m [1m2:11[0m 6s/step - accuracy: 0.1891 - loss: 1.9042 - top_k_categorical_accuracy: 0.8483
[1m10/30[0m [32m======[0m[37m==============[0m [1m2:05[0m 6s/step - accuracy: 0.1886 - loss: 1.9075 - top_k_categorical_accuracy: 0.8485
[1m11/30[0m [32m=======[0m[37m=============[0m [1m1:59[0m 6s/step - accuracy: 0.1880 - loss: 1.9109 - top_k_categorical_accuracy: 0.8486
[1m12/30[0m [32m========[0m[37m============[0m [1m1:55[0m 6s/step - accuracy: 0.1873 - loss: 1.9137 - top_k_categorical_accuracy: 0.8486
[1m13/30[0m [32m========[0m[37m============[0m [1m1:49[0m 6s/step - accuracy: 0.1862 - loss: 1.9184 - top_k_categorical_accuracy: 0.8478
[1m14/30[0m [32m=========[0m[37m===========[0m [1m1:43[0m 6s/step - accuracy: 0.1852 - loss: 1.9226 - top_k_categorical_accuracy: 0.8476
[1m15/30[0m [32m==========[0m[37m==========[0m [1m1:36[0m 6s/step - accuracy: 0.1844 - loss: 1.9263 - top_k_categorical_accuracy: 0.8472
[1m16/30[0m [32m==========[0m[37m==========[0m [1m1:30[0m 6s/step - accuracy: 0.1835 - loss: 1.9299 - top_k_categorical_accuracy: 0.8467
[1m17/30[0m [32m===========[0m[37m=========[0m [1m1:23[0m 6s/step - accuracy: 0.1825 - loss: 1.9332 - top_k_categorical_accuracy: 0.8465
[1m18/30[0m [32m============[0m[37m========[0m [1m1:17[0m 6s/step - accuracy: 0.1818 - loss: 1.9357 - top_k_categorical_accuracy: 0.8465
[1m19/30[0m [32m============[0m[37m========[0m [1m1:11[0m 6s/step - accuracy: 0.1814 - loss: 1.9377 - top_k_categorical_accuracy: 0.8465
[1m20/30[0m [32m=============[0m[37m=======[0m [1m1:05[0m 7s/step - accuracy: 0.1808 - loss: 1.9402 - top_k_categorical_accuracy: 0.8464
[1m21/30[0m [32m==============[0m[37m======[0m [1m59s[0m 7s/step - accuracy: 0.1801 - loss: 1.9423 - top_k_categorical_accuracy: 0.8465 
[1m22/30[0m [32m==============[0m[37m======[0m [1m52s[0m 7s/step - accuracy: 0.1796 - loss: 1.9440 - top_k_categorical_accuracy: 0.8467
[1m23/30[0m [32m===============[0m[37m=====[0m [1m46s[0m 7s/step - accuracy: 0.1791 - loss: 1.9452 - top_k_categorical_accuracy: 0.8469
[1m24/30[0m [32m================[0m[37m====[0m [1m39s[0m 7s/step - accuracy: 0.1787 - loss: 1.9461 - top_k_categorical_accuracy: 0.8471
[1m25/30[0m [32m================[0m[37m====[0m [1m32s[0m 7s/step - accuracy: 0.1782 - loss: 1.9470 - top_k_categorical_accuracy: 0.8472
[1m26/30[0m [32m=================[0m[37m===[0m [1m26s[0m 7s/step - accuracy: 0.1777 - loss: 1.9481 - top_k_categorical_accuracy: 0.8473
[1m27/30[0m [32m==================[0m[37m==[0m [1m19s[0m 7s/step - accuracy: 0.1772 - loss: 1.9492 - top_k_categorical_accuracy: 0.8473
[1m28/30[0m [32m==================[0m[37m==[0m [1m13s[0m 7s/step - accuracy: 0.1766 - loss: 1.9503 - top_k_categorical_accuracy: 0.8474
[1m29/30[0m [32m===================[0m[37m=[0m [1m6s[0m 7s/step - accuracy: 0.1762 - loss: 1.9513 - top_k_categorical_accuracy: 0.8475 
[1m30/30[0m [32m====================[0m[37m[0m [1m0s[0m 7s/step - accuracy: 0.1759 - loss: 1.9522 - top_k_categorical_accuracy: 0.8476
Epoch 18: val_accuracy did not improve from 0.21339

[1m30/30[0m [32m====================[0m[37m[0m [1m256s[0m 9s/step - accuracy: 0.1667 - loss: 1.9780 - top_k_categorical_accuracy: 0.8490 - val_accuracy: 0.1841 - val_loss: 1.7776 - val_top_k_categorical_accuracy: 0.8368 - learning_rate: 2.5000e-04
Epoch 19/50

[1m 1/30[0m [37m====================[0m [1m7:06[0m 15s/step - accuracy: 0.0938 - loss: 2.0349 - top_k_categorical_accuracy: 0.8438
[1m 2/30[0m [32m=[0m[37m===================[0m [1m2:05[0m 4s/step - accuracy: 0.1016 - loss: 2.0647 - top_k_categorical_accuracy: 0.8281 
[1m 3/30[0m [32m==[0m[37m==================[0m [1m2:14[0m 5s/step - accuracy: 0.0955 - loss: 2.0897 - top_k_categorical_accuracy: 0.8160
[1m 4/30[0m [32m==[0m[37m==================[0m [1m2:19[0m 5s/step - accuracy: 0.1009 - loss: 2.0889 - top_k_categorical_accuracy: 0.8151
[1m 5/30[0m [32m===[0m[37m=================[0m [1m2:16[0m 5s/step - accuracy: 0.1082 - loss: 2.0833 - top_k_categorical_accuracy: 0.8146
[1m 6/30[0m [32m====[0m[37m================[0m [1m2:16[0m 6s/step - accuracy: 0.1136 - loss: 2.0784 - top_k_categorical_accuracy: 0.8134
[1m 7/30[0m [32m====[0m[37m================[0m [1m2:11[0m 6s/step - accuracy: 0.1178 - loss: 2.0723 - top_k_categorical_accuracy: 0.8152
[1m 8/30[0m [32m=====[0m[37m===============[0m [1m2:07[0m 6s/step - accuracy: 0.1221 - loss: 2.0659 - top_k_categorical_accuracy: 0.8173
[1m 9/30[0m [32m======[0m[37m==============[0m [1m2:05[0m 6s/step - accuracy: 0.1255 - loss: 2.0611 - top_k_categorical_accuracy: 0.8187
[1m10/30[0m [32m======[0m[37m==============[0m [1m2:02[0m 6s/step - accuracy: 0.1283 - loss: 2.0580 - top_k_categorical_accuracy: 0.8196
[1m11/30[0m [32m=======[0m[37m=============[0m [1m1:56[0m 6s/step - accuracy: 0.1311 - loss: 2.0559 - top_k_categorical_accuracy: 0.8197
[1m12/30[0m [32m========[0m[37m============[0m [1m1:49[0m 6s/step - accuracy: 0.1341 - loss: 2.0528 - top_k_categorical_accuracy: 0.8204
[1m13/30[0m [32m========[0m[37m============[0m [1m1:43[0m 6s/step - accuracy: 0.1359 - loss: 2.0516 - top_k_categorical_accuracy: 0.8209
[1m14/30[0m [32m=========[0m[37m===========[0m [1m1:36[0m 6s/step - accuracy: 0.1376 - loss: 2.0498 - top_k_categorical_accuracy: 0.8219
[1m15/30[0m [32m==========[0m[37m==========[0m [1m1:30[0m 6s/step - accuracy: 0.1385 - loss: 2.0484 - top_k_categorical_accuracy: 0.8228
[1m16/30[0m [32m==========[0m[37m==========[0m [1m1:24[0m 6s/step - accuracy: 0.1399 - loss: 2.0461 - top_k_categorical_accuracy: 0.8238
[1m17/30[0m [32m===========[0m[37m=========[0m [1m1:18[0m 6s/step - accuracy: 0.1412 - loss: 2.0438 - top_k_categorical_accuracy: 0.8248
[1m18/30[0m [32m============[0m[37m========[0m [1m1:13[0m 6s/step - accuracy: 0.1424 - loss: 2.0416 - top_k_categorical_accuracy: 0.8255
[1m19/30[0m [32m============[0m[37m========[0m [1m1:07[0m 6s/step - accuracy: 0.1436 - loss: 2.0397 - top_k_categorical_accuracy: 0.8260
[1m20/30[0m [32m=============[0m[37m=======[0m [1m1:02[0m 6s/step - accuracy: 0.1447 - loss: 2.0384 - top_k_categorical_accuracy: 0.8263
[1m21/30[0m [32m==============[0m[37m======[0m [1m56s[0m 6s/step - accuracy: 0.1454 - loss: 2.0373 - top_k_categorical_accuracy: 0.8267 
[1m22/30[0m [32m==============[0m[37m======[0m [1m49s[0m 6s/step - accuracy: 0.1459 - loss: 2.0359 - top_k_categorical_accuracy: 0.8271
[1m23/30[0m [32m===============[0m[37m=====[0m [1m43s[0m 6s/step - accuracy: 0.1462 - loss: 2.0345 - top_k_categorical_accuracy: 0.8278
[1m24/30[0m [32m================[0m[37m====[0m [1m37s[0m 6s/step - accuracy: 0.1465 - loss: 2.0333 - top_k_categorical_accuracy: 0.8281
[1m25/30[0m [32m================[0m[37m====[0m [1m31s[0m 6s/step - accuracy: 0.1469 - loss: 2.0319 - top_k_categorical_accuracy: 0.8285
[1m26/30[0m [32m=================[0m[37m===[0m [1m25s[0m 6s/step - accuracy: 0.1472 - loss: 2.0306 - top_k_categorical_accuracy: 0.8289
[1m27/30[0m [32m==================[0m[37m==[0m [1m18s[0m 6s/step - accuracy: 0.1476 - loss: 2.0292 - top_k_categorical_accuracy: 0.8294
[1m28/30[0m [32m==================[0m[37m==[0m [1m12s[0m 6s/step - accuracy: 0.1481 - loss: 2.0279 - top_k_categorical_accuracy: 0.8297
[1m29/30[0m [32m===================[0m[37m=[0m [1m6s[0m 6s/step - accuracy: 0.1486 - loss: 2.0264 - top_k_categorical_accuracy: 0.8301 
[1m30/30[0m [32m====================[0m[37m[0m [1m0s[0m 6s/step - accuracy: 0.1491 - loss: 2.0250 - top_k_categorical_accuracy: 0.8304
Epoch 19: val_accuracy did not improve from 0.21339

Epoch 19: ReduceLROnPlateau reducing learning rate to 0.0001250000059371814.

[1m30/30[0m [32m====================[0m[37m[0m [1m248s[0m 8s/step - accuracy: 0.1656 - loss: 1.9823 - top_k_categorical_accuracy: 0.8406 - val_accuracy: 0.2092 - val_loss: 1.7775 - val_top_k_categorical_accuracy: 0.8326 - learning_rate: 2.5000e-04
Epoch 19: early stopping
Restoring model weights from the end of the best epoch: 9.

[INFO] Starting fine-tuning (Phase 2: Unfreezing top layers)...
Epoch 1/25

[1m 1/30[0m [37m====================[0m [1m1:58:00[0m 244s/step - accuracy: 0.3438 - loss: 1.9403 - top_k_categorical_accuracy: 0.8438
[1m 2/30[0m [32m=[0m[37m===================[0m [1m2:11[0m 5s/step - accuracy: 0.3359 - loss: 1.9651 - top_k_categorical_accuracy: 0.8359     
[1m 3/30[0m [32m==[0m[37m==================[0m [1m2:20[0m 5s/step - accuracy: 0.3142 - loss: 2.0193 - top_k_categorical_accuracy: 0.8316
[1m 4/30[0m [32m==[0m[37m==================[0m [1m2:12[0m 5s/step - accuracy: 0.2923 - loss: 2.0535 - top_k_categorical_accuracy: 0.8327
[1m 5/30[0m [32m===[0m[37m=================[0m [1m2:06[0m 5s/step - accuracy: 0.2764 - loss: 2.0723 - top_k_categorical_accuracy: 0.8349
[1m 6/30[0m [32m====[0m[37m================[0m [1m1:56[0m 5s/step - accuracy: 0.2685 - loss: 2.0746 - top_k_categorical_accuracy: 0.8390
[1m 7/30[0m [32m====[0m[37m================[0m [1m1:50[0m 5s/step - accuracy: 0.2607 - loss: 2.0806 - top_k_categorical_accuracy: 0.8428
[1m 8/30[0m [32m=====[0m[37m===============[0m [1m2:01[0m 6s/step - accuracy: 0.2535 - loss: 2.0878 - top_k_categorical_accuracy: 0.8439
[1m 9/30[0m [32m======[0m[37m==============[0m [1m2:08[0m 6s/step - accuracy: 0.2477 - loss: 2.0956 - top_k_categorical_accuracy: 0.8447
[1m10/30[0m [32m======[0m[37m==============[0m [1m1:56[0m 6s/step - accuracy: 0.2433 - loss: 2.1016 - top_k_categorical_accuracy: 0.8452
[1m11/30[0m [32m=======[0m[37m=============[0m [1m1:48[0m 6s/step - accuracy: 0.2395 - loss: 2.1045 - top_k_categorical_accuracy: 0.8459
[1m12/30[0m [32m========[0m[37m============[0m [1m1:41[0m 6s/step - accuracy: 0.2365 - loss: 2.1074 - top_k_categorical_accuracy: 0.8455
[1m13/30[0m [32m========[0m[37m============[0m [1m1:34[0m 6s/step - accuracy: 0.2344 - loss: 2.1099 - top_k_categorical_accuracy: 0.8450
[1m14/30[0m [32m=========[0m[37m===========[0m [1m1:27[0m 5s/step - accuracy: 0.2323 - loss: 2.1119 - top_k_categorical_accuracy: 0.8450
[1m15/30[0m [32m==========[0m[37m==========[0m [1m1:21[0m 5s/step - accuracy: 0.2304 - loss: 2.1137 - top_k_categorical_accuracy: 0.8448
[1m16/30[0m [32m==========[0m[37m==========[0m [1m1:14[0m 5s/step - accuracy: 0.2284 - loss: 2.1161 - top_k_categorical_accuracy: 0.8447
[1m17/30[0m [32m===========[0m[37m=========[0m [1m1:10[0m 5s/step - accuracy: 0.2264 - loss: 2.1180 - top_k_categorical_accuracy: 0.8448
[1m18/30[0m [32m============[0m[37m========[0m [1m1:06[0m 6s/step - accuracy: 0.2246 - loss: 2.1193 - top_k_categorical_accuracy: 0.8449
[1m19/30[0m [32m============[0m[37m========[0m [1m1:05[0m 6s/step - accuracy: 0.2227 - loss: 2.1202 - top_k_categorical_accuracy: 0.8451
[1m20/30[0m [32m=============[0m[37m=======[0m [1m1:00[0m 6s/step - accuracy: 0.2210 - loss: 2.1217 - top_k_categorical_accuracy: 0.8452
[1m21/30[0m [32m==============[0m[37m======[0m [1m54s[0m 6s/step - accuracy: 0.2193 - loss: 2.1231 - top_k_categorical_accuracy: 0.8452 
[1m22/30[0m [32m==============[0m[37m======[0m [1m48s[0m 6s/step - accuracy: 0.2178 - loss: 2.1249 - top_k_categorical_accuracy: 0.8450
[1m23/30[0m [32m===============[0m[37m=====[0m [1m43s[0m 6s/step - accuracy: 0.2165 - loss: 2.1263 - top_k_categorical_accuracy: 0.8448
[1m24/30[0m [32m================[0m[37m====[0m [1m36s[0m 6s/step - accuracy: 0.2152 - loss: 2.1274 - top_k_categorical_accuracy: 0.8449
[1m25/30[0m [32m================[0m[37m====[0m [1m30s[0m 6s/step - accuracy: 0.2140 - loss: 2.1284 - top_k_categorical_accuracy: 0.8447
[1m26/30[0m [32m=================[0m[37m===[0m [1m24s[0m 6s/step - accuracy: 0.2131 - loss: 2.1289 - top_k_categorical_accuracy: 0.8447
[1m27/30[0m [32m==================[0m[37m==[0m [1m19s[0m 6s/step - accuracy: 0.2124 - loss: 2.1295 - top_k_categorical_accuracy: 0.8446
[1m28/30[0m [32m==================[0m[37m==[0m [1m12s[0m 6s/step - accuracy: 0.2117 - loss: 2.1300 - top_k_categorical_accuracy: 0.8446
[1m29/30[0m [32m===================[0m[37m=[0m [1m6s[0m 6s/step - accuracy: 0.2110 - loss: 2.1304 - top_k_categorical_accuracy: 0.8447 
[1m30/30[0m [32m====================[0m[37m[0m [1m0s[0m 6s/step - accuracy: 0.2103 - loss: 2.1306 - top_k_categorical_accuracy: 0.8448
Epoch 1: val_accuracy did not improve from 0.21339

[1m30/30[0m [32m====================[0m[37m[0m [1m509s[0m 9s/step - accuracy: 0.1896 - loss: 2.1377 - top_k_categorical_accuracy: 0.8479 - val_accuracy: 0.1632 - val_loss: 1.8326 - val_top_k_categorical_accuracy: 0.8870 - learning_rate: 1.0000e-04
Epoch 2/25

[1m 1/30[0m [37m====================[0m [1m3:31[0m 7s/step - accuracy: 0.3750 - loss: 2.0084 - top_k_categorical_accuracy: 0.9375
[1m 2/30[0m [32m=[0m[37m===================[0m [1m6:45[0m 14s/step - accuracy: 0.3281 - loss: 2.0369 - top_k_categorical_accuracy: 0.9219
[1m 3/30[0m [32m==[0m[37m==================[0m [1m4:38[0m 10s/step - accuracy: 0.3125 - loss: 2.0635 - top_k_categorical_accuracy: 0.9132
[1m 4/30[0m [32m==[0m[37m==================[0m [1m3:44[0m 9s/step - accuracy: 0.2988 - loss: 2.0775 - top_k_categorical_accuracy: 0.9017 
[1m 5/30[0m [32m===[0m[37m=================[0m [1m3:13[0m 8s/step - accuracy: 0.2916 - loss: 2.0754 - top_k_categorical_accuracy: 0.8964
[1m 6/30[0m [32m====[0m[37m================[0m [1m2:51[0m 7s/step - accuracy: 0.2872 - loss: 2.0751 - top_k_categorical_accuracy: 0.8902
[1m 7/30[0m [32m====[0m[37m================[0m [1m2:36[0m 7s/step - accuracy: 0.2826 - loss: 2.0752 - top_k_categorical_accuracy: 0.8861
[1m 8/30[0m [32m=====[0m[37m===============[0m [1m2:24[0m 7s/step - accuracy: 0.2800 - loss: 2.0725 - top_k_categorical_accuracy: 0.8828
[1m 9/30[0m [32m======[0m[37m==============[0m [1m2:14[0m 6s/step - accuracy: 0.2778 - loss: 2.0688 - top_k_categorical_accuracy: 0.8800
[1m10/30[0m [32m======[0m[37m==============[0m [1m2:03[0m 6s/step - accuracy: 0.2747 - loss: 2.0676 - top_k_categorical_accuracy: 0.8776
[1m11/30[0m [32m=======[0m[37m=============[0m [1m1:53[0m 6s/step - accuracy: 0.2719 - loss: 2.0657 - top_k_categorical_accuracy: 0.8763
[1m12/30[0m [32m========[0m[37m============[0m [1m1:46[0m 6s/step - accuracy: 0.2688 - loss: 2.0646 - top_k_categorical_accuracy: 0.8754
[1m13/30[0m [32m========[0m[37m============[0m [1m1:40[0m 6s/step - accuracy: 0.2659 - loss: 2.0656 - top_k_categorical_accuracy: 0.8744
[1m14/30[0m [32m=========[0m[37m===========[0m [1m1:33[0m 6s/step - accuracy: 0.2628 - loss: 2.0670 - top_k_categorical_accuracy: 0.8735
[1m15/30[0m [32m==========[0m[37m==========[0m [1m1:27[0m 6s/step - accuracy: 0.2600 - loss: 2.0685 - top_k_categorical_accuracy: 0.8730
[1m16/30[0m [32m==========[0m[37m==========[0m [1m1:21[0m 6s/step - accuracy: 0.2572 - loss: 2.0696 - top_k_categorical_accuracy: 0.8727
[1m17/30[0m [32m===========[0m[37m=========[0m [1m1:14[0m 6s/step - accuracy: 0.2545 - loss: 2.0707 - top_k_categorical_accuracy: 0.8724
[1m18/30[0m [32m============[0m[37m========[0m [1m1:08[0m 6s/step - accuracy: 0.2519 - loss: 2.0723 - top_k_categorical_accuracy: 0.8718
[1m19/30[0m [32m============[0m[37m========[0m [1m1:02[0m 6s/step - accuracy: 0.2497 - loss: 2.0734 - top_k_categorical_accuracy: 0.8716
[1m20/30[0m [32m=============[0m[37m=======[0m [1m56s[0m 6s/step - accuracy: 0.2474 - loss: 2.0749 - top_k_categorical_accuracy: 0.8713 
[1m21/30[0m [32m==============[0m[37m======[0m [1m50s[0m 6s/step - accuracy: 0.2453 - loss: 2.0761 - top_k_categorical_accuracy: 0.8710
[1m22/30[0m [32m==============[0m[37m======[0m [1m45s[0m 6s/step - accuracy: 0.2432 - loss: 2.0773 - top_k_categorical_accuracy: 0.8707
[1m23/30[0m [32m===============[0m[37m=====[0m [1m39s[0m 6s/step - accuracy: 0.2414 - loss: 2.0780 - top_k_categorical_accuracy: 0.8705
[1m24/30[0m [32m================[0m[37m====[0m [1m33s[0m 6s/step - accuracy: 0.2396 - loss: 2.0789 - top_k_categorical_accuracy: 0.8703
[1m25/30[0m [32m================[0m[37m====[0m [1m28s[0m 6s/step - accuracy: 0.2378 - loss: 2.0804 - top_k_categorical_accuracy: 0.8702
[1m26/30[0m [32m=================[0m[37m===[0m [1m22s[0m 6s/step - accuracy: 0.2361 - loss: 2.0815 - top_k_categorical_accuracy: 0.8701
[1m27/30[0m [32m==================[0m[37m==[0m [1m16s[0m 6s/step - accuracy: 0.2345 - loss: 2.0826 - top_k_categorical_accuracy: 0.8700
[1m28/30[0m [32m==================[0m[37m==[0m [1m11s[0m 6s/step - accuracy: 0.2330 - loss: 2.0836 - top_k_categorical_accuracy: 0.8699
[1m29/30[0m [32m===================[0m[37m=[0m [1m5s[0m 6s/step - accuracy: 0.2314 - loss: 2.0848 - top_k_categorical_accuracy: 0.8699 
[1m30/30[0m [32m====================[0m[37m[0m [1m0s[0m 6s/step - accuracy: 0.2299 - loss: 2.0863 - top_k_categorical_accuracy: 0.8698Traceback (most recent call last):
  File "C:\Users\avi\OneDrive - Sri Lanka Institute of Information Technology\Desktop\Personalized-Autism-Therapy-Support-System\ml_service\train_model.py", line 413, in <module>
    model, history = train_model()
                     ^^^^^^^^^^^^^
  File "C:\Users\avi\OneDrive - Sri Lanka Institute of Information Technology\Desktop\Personalized-Autism-Therapy-Support-System\ml_service\train_model.py", line 333, in train_model
    history2 = model.fit(
               ^^^^^^^^^^
  File "C:\Users\avi\AppData\Roaming\Python\Python311\site-packages\keras\src\utils\traceback_utils.py", line 117, in error_handler
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\avi\AppData\Roaming\Python\Python311\site-packages\keras\src\backend\tensorflow\trainer.py", line 423, in fit
    val_logs = self.evaluate(
               ^^^^^^^^^^^^^^
  File "C:\Users\avi\AppData\Roaming\Python\Python311\site-packages\keras\src\utils\traceback_utils.py", line 117, in error_handler
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\avi\AppData\Roaming\Python\Python311\site-packages\keras\src\backend\tensorflow\trainer.py", line 511, in evaluate
    logs = self.test_function(iterator)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\avi\AppData\Roaming\Python\Python311\site-packages\keras\src\backend\tensorflow\trainer.py", line 241, in function
    opt_outputs = multi_step_on_iterator(iterator)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\avi\AppData\Roaming\Python\Python311\site-packages\tensorflow\python\util\traceback_utils.py", line 150, in error_handler
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\avi\AppData\Roaming\Python\Python311\site-packages\tensorflow\python\eager\polymorphic_function\polymorphic_function.py", line 833, in __call__
    result = self._call(*args, **kwds)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\avi\AppData\Roaming\Python\Python311\site-packages\tensorflow\python\eager\polymorphic_function\polymorphic_function.py", line 878, in _call
    results = tracing_compilation.call_function(
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\avi\AppData\Roaming\Python\Python311\site-packages\tensorflow\python\eager\polymorphic_function\tracing_compilation.py", line 139, in call_function
    return function._call_flat(  # pylint: disable=protected-access
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\avi\AppData\Roaming\Python\Python311\site-packages\tensorflow\python\eager\polymorphic_function\concrete_function.py", line 1322, in _call_flat
    return self._inference_function.call_preflattened(args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\avi\AppData\Roaming\Python\Python311\site-packages\tensorflow\python\eager\polymorphic_function\atomic_function.py", line 216, in call_preflattened
    flat_outputs = self.call_flat(*args)
                   ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\avi\AppData\Roaming\Python\Python311\site-packages\tensorflow\python\eager\polymorphic_function\atomic_function.py", line 251, in call_flat
    outputs = self._bound_context.call_function(
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\avi\AppData\Roaming\Python\Python311\site-packages\tensorflow\python\eager\context.py", line 1688, in call_function
    outputs = execute.execute(
              ^^^^^^^^^^^^^^^^
  File "C:\Users\avi\AppData\Roaming\Python\Python311\site-packages\tensorflow\python\eager\execute.py", line 53, in quick_execute
    tensors = pywrap_tfe.TFE_Py_Execute(ctx._handle, device_name, op_name,
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt
2025-12-03 16:32:58.253986: W tensorflow/core/kernels/data/generator_dataset_op.cc:110] Error occurred when finalizing GeneratorDataset iterator: FAILED_PRECONDITION: Python interpreter state is not initialized. The process may be terminated.
	 [[{{node PyFunc}}]]
^C